import{m as I,r as P,t as m,a as o,j as e,B as l,C as p,b as j,d as f,f as g,e as U,o as D,p as w,q as A,s as F,v as O,h as r,I as c,w as S}from"./index-DG0yx2hi.js";import{A as $}from"./AdminLayout-CapzJ-JK.js";import{T}from"./textarea-BfRN5q_Y.js";import{B as k}from"./popover-Bqiz4euq.js";import{T as G,a as Q,b,c as n,d as J,e as d}from"./table-DeOYaLOA.js";import{S as E}from"./switch-DwIsyt3g.js";import{P as K}from"./plus-DIKUpKHa.js";import{P as W}from"./package-CC5WVNv6.js";import{D as X}from"./layout-dashboard-CC4g-mOh.js";import{S as Y}from"./square-pen-D7F5zf6L.js";import{T as Z}from"./trash-2-6I2MbiK3.js";import"./scroll-area-C0S6gB82.js";import"./index-BdQq_4o_.js";import"./wallet-CKmMh37E.js";import"./users-DD1qYPM2.js";import"./user-B4BzRHVK.js";import"./index-r4-iOF84.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=I("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=I("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);function ge(){const[q,x]=P.useState(!1),[V,h]=P.useState(!1),[t,v]=P.useState(null),{data:i,refetch:N}=m.creditPackages.listAll.useQuery();m.useUtils();const y=m.creditPackages.create.useMutation({onSuccess:()=>{o.success("Pacote criado com sucesso!"),x(!1),N()},onError:s=>{o.error("Erro ao criar pacote: "+s.message)}}),u=m.creditPackages.update.useMutation({onSuccess:()=>{o.success("Pacote atualizado com sucesso!"),h(!1),v(null),N()},onError:s=>{o.error("Erro ao atualizar pacote: "+s.message)}}),B=m.creditPackages.delete.useMutation({onSuccess:()=>{o.success("Pacote desativado com sucesso!"),N()},onError:s=>{o.error("Erro ao desativar pacote: "+s.message)}}),M=s=>{s.preventDefault();const a=new FormData(s.currentTarget);y.mutate({name:a.get("name"),description:a.get("description")||void 0,credits:Number(a.get("credits")),priceInCents:Math.round(Number(a.get("price"))*100),discountPercent:Number(a.get("discount"))||0,displayOrder:Number(a.get("displayOrder"))||0})},z=s=>{if(s.preventDefault(),!t)return;const a=new FormData(s.currentTarget);u.mutate({id:t.id,name:a.get("name"),description:a.get("description")||void 0,credits:Number(a.get("credits")),priceInCents:Math.round(Number(a.get("price"))*100),discountPercent:Number(a.get("discount"))||0,displayOrder:Number(a.get("displayOrder"))||0,isActive:a.get("isActive")==="on"})},R=s=>{u.mutate({id:s.id,isActive:!s.isActive})},C=s=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(s/100),H=(s,a)=>{const L=s*a/100;return s-L};return e.jsx($,{children:e.jsxs("div",{className:"space-y-8 animate-fade-in",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Pacotes de Créditos"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Configure pacotes, preços e ofertas especiais para venda de créditos"})]}),e.jsxs(l,{onClick:()=>x(!0),className:"gradient-primary",children:[e.jsx(K,{className:"mr-2 h-4 w-4"}),"Novo Pacote"]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(p,{children:[e.jsxs(j,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(f,{className:"text-sm font-medium",children:"Total de Pacotes"}),e.jsx(W,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(g,{children:[e.jsx("div",{className:"text-2xl font-bold",children:i?.length||0}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[i?.filter(s=>s.isActive).length||0," ativos"]})]})]}),e.jsxs(p,{children:[e.jsxs(j,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(f,{className:"text-sm font-medium",children:"Pacote Mais Popular"}),e.jsx(X,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(g,{children:[e.jsx("div",{className:"text-2xl font-bold",children:i&&i.length>0?i[0].name:"-"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:i&&i.length>0?`${i[0].credits} créditos`:"Nenhum pacote"})]})]}),e.jsxs(p,{children:[e.jsxs(j,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(f,{className:"text-sm font-medium",children:"Descontos Ativos"}),e.jsx(ee,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(g,{children:[e.jsx("div",{className:"text-2xl font-bold",children:i?.filter(s=>s.isActive&&s.discountPercent>0).length||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Pacotes com desconto"})]})]})]}),e.jsxs(p,{children:[e.jsxs(j,{children:[e.jsx(f,{children:"Pacotes Disponíveis"}),e.jsx(U,{children:"Gerencie todos os pacotes de créditos disponíveis para venda"})]}),e.jsx(g,{children:e.jsxs(G,{children:[e.jsx(Q,{children:e.jsxs(b,{children:[e.jsx(n,{className:"w-[50px]",children:e.jsx(_,{className:"h-4 w-4"})}),e.jsx(n,{children:"Nome"}),e.jsx(n,{children:"Créditos"}),e.jsx(n,{children:"Preço"}),e.jsx(n,{children:"Desconto"}),e.jsx(n,{children:"Preço Final"}),e.jsx(n,{children:"Status"}),e.jsx(n,{className:"text-right",children:"Ações"})]})}),e.jsx(J,{children:i&&i.length>0?i.map(s=>e.jsxs(b,{children:[e.jsx(d,{className:"font-medium text-muted-foreground",children:s.displayOrder}),e.jsx(d,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.name}),s.description&&e.jsx("div",{className:"text-sm text-muted-foreground",children:s.description})]})}),e.jsx(d,{children:e.jsxs(k,{variant:"secondary",children:[s.credits," créditos"]})}),e.jsx(d,{children:C(s.priceInCents)}),e.jsx(d,{children:s.discountPercent>0?e.jsxs(k,{variant:"destructive",children:[s.discountPercent,"% OFF"]}):e.jsx("span",{className:"text-muted-foreground",children:"-"})}),e.jsx(d,{className:"font-bold",children:C(H(s.priceInCents,s.discountPercent))}),e.jsx(d,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{checked:s.isActive,onCheckedChange:()=>R(s)}),e.jsx("span",{className:"text-sm",children:s.isActive?"Ativo":"Inativo"})]})}),e.jsx(d,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>{v(s),h(!0)},children:e.jsx(Y,{className:"h-4 w-4"})}),e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>{confirm("Deseja realmente desativar este pacote?")&&B.mutate({id:s.id})},children:e.jsx(Z,{className:"h-4 w-4"})})]})})]},s.id)):e.jsx(b,{children:e.jsx(d,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:"Nenhum pacote cadastrado. Crie o primeiro pacote para começar!"})})})]})})]}),e.jsx(D,{open:q,onOpenChange:x,children:e.jsxs(w,{className:"max-w-md",children:[e.jsxs(A,{children:[e.jsx(F,{children:"Criar Novo Pacote"}),e.jsx(O,{children:"Configure um novo pacote de créditos para venda"})]}),e.jsxs("form",{onSubmit:M,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"name",children:"Nome do Pacote *"}),e.jsx(c,{id:"name",name:"name",placeholder:"Ex: Pacote Básico",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"description",children:"Descrição"}),e.jsx(T,{id:"description",name:"description",placeholder:"Descrição opcional do pacote",rows:2})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"credits",children:"Créditos *"}),e.jsx(c,{id:"credits",name:"credits",type:"number",min:"1",placeholder:"10",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"price",children:"Preço (R$) *"}),e.jsx(c,{id:"price",name:"price",type:"number",min:"0",step:"0.01",placeholder:"100.00",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"discount",children:"Desconto (%)"}),e.jsx(c,{id:"discount",name:"discount",type:"number",min:"0",max:"100",placeholder:"0",defaultValue:"0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"displayOrder",children:"Ordem de Exibição"}),e.jsx(c,{id:"displayOrder",name:"displayOrder",type:"number",min:"0",placeholder:"0",defaultValue:"0"})]})]}),e.jsxs(S,{children:[e.jsx(l,{type:"button",variant:"outline",onClick:()=>x(!1),children:"Cancelar"}),e.jsx(l,{type:"submit",disabled:y.isPending,children:y.isPending?"Criando...":"Criar Pacote"})]})]})]})}),e.jsx(D,{open:V,onOpenChange:h,children:e.jsxs(w,{className:"max-w-md",children:[e.jsxs(A,{children:[e.jsx(F,{children:"Editar Pacote"}),e.jsx(O,{children:"Atualize as informações do pacote"})]}),t&&e.jsxs("form",{onSubmit:z,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"edit-name",children:"Nome do Pacote *"}),e.jsx(c,{id:"edit-name",name:"name",defaultValue:t.name,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"edit-description",children:"Descrição"}),e.jsx(T,{id:"edit-description",name:"description",defaultValue:t.description||"",rows:2})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"edit-credits",children:"Créditos *"}),e.jsx(c,{id:"edit-credits",name:"credits",type:"number",min:"1",defaultValue:t.credits,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"edit-price",children:"Preço (R$) *"}),e.jsx(c,{id:"edit-price",name:"price",type:"number",min:"0",step:"0.01",defaultValue:(t.priceInCents/100).toFixed(2),required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"edit-discount",children:"Desconto (%)"}),e.jsx(c,{id:"edit-discount",name:"discount",type:"number",min:"0",max:"100",defaultValue:t.discountPercent})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"edit-displayOrder",children:"Ordem de Exibição"}),e.jsx(c,{id:"edit-displayOrder",name:"displayOrder",type:"number",min:"0",defaultValue:t.displayOrder})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(E,{id:"edit-isActive",name:"isActive",defaultChecked:t.isActive}),e.jsx(r,{htmlFor:"edit-isActive",children:"Pacote ativo"})]}),e.jsxs(S,{children:[e.jsx(l,{type:"button",variant:"outline",onClick:()=>{h(!1),v(null)},children:"Cancelar"}),e.jsx(l,{type:"submit",disabled:u.isPending,children:u.isPending?"Salvando...":"Salvar Alterações"})]})]})]})})]})})}export{ge as default};
