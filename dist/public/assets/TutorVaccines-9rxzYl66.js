import{aE as Q,r as C,t as r,a as V,j as e,L as M,B as o,o as z,A as $,p as G,q as U,s as J,v as K,h as i,I as t,w as W,C as h,b as u,d as j,i as X,e as I,f as g}from"./index-DG0yx2hi.js";import{T as Y}from"./TutorLayout-lMG2oLBz.js";import{T as Z}from"./textarea-BfRN5q_Y.js";import{S as _,a as ee,b as ae,c as se,d as ie}from"./select-k5kl2mY3.js";import{B as v,S as T}from"./popover-Bqiz4euq.js";import{R as A}from"./RecentChangeIndicator-dH2jnUR2.js";import{A as te}from"./arrow-left-B-xkxJNp.js";import{P as ne}from"./plus-DIKUpKHa.js";import"./NotificationBell-BIuiN9Fe.js";import"./pt-BR-BIS3WgEC.js";import"./info-DReA-lTp.js";import"./message-square-COhalQ2E.js";import"./chart-column-B4FPjduw.js";import"./package-CC5WVNv6.js";import"./user-B4BzRHVK.js";import"./index-BdQq_4o_.js";import"./index-r4-iOF84.js";import"./chevron-down-CKVtRMqG.js";import"./check-DDByOptX.js";import"./clock-BQzFMz2h.js";function Ce(){const[,N]=Q("/tutor/pets/:id/vaccines"),n=N?.id?parseInt(N.id):0,[R,d]=C.useState(!1),[l,F]=C.useState(null),{data:L}=r.pets.byId.useQuery({id:n}),{data:c,refetch:P}=r.vaccines.getPetVaccinations.useQuery({petId:n}),{data:D}=r.vaccines.library.useQuery(),{data:b}=r.changeHistory.getPetHistory.useQuery({petId:n}),f=a=>b?b.filter(s=>s.resourceType==="preventive"&&s.resourceId===a).sort((s,p)=>new Date(p.createdAt).getTime()-new Date(s.createdAt).getTime()).slice(0,3):[],m=r.vaccines.addVaccination.useMutation({onSuccess:()=>{V.success("Vacina registrada com sucesso!"),d(!1),P()},onError:a=>{V.error("Erro ao registrar vacina: "+a.message)}}),B=a=>{a.preventDefault();const s=new FormData(a.currentTarget),p=parseInt(s.get("vaccineId")),E=s.get("applicationDate"),w=s.get("nextDueDate"),S=s.get("doseNumber"),H=s.get("veterinarian"),O=s.get("clinic"),q=s.get("batchNumber"),k=s.get("notes");m.mutate({petId:n,vaccineId:p,applicationDate:new Date(E),nextDueDate:w?new Date(w):void 0,doseNumber:S?parseInt(S):void 0,veterinarian:H||void 0,clinic:O||void 0,batchNumber:q||void 0,notes:k||void 0})},x=new Date,y=c?.filter(a=>a.vaccination.nextDueDate&&new Date(a.vaccination.nextDueDate)>x)||[];return c?.filter(a=>!a.vaccination.nextDueDate||new Date(a.vaccination.nextDueDate)<=x),e.jsx(Y,{children:e.jsxs("div",{className:"container max-w-7xl py-8 space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(M,{href:`/tutor/pets/${n}`,children:e.jsx(o,{variant:"ghost",size:"icon",children:e.jsx(te,{className:"h-5 w-5"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Carteira de Vacina√ß√£o"}),e.jsx("p",{className:"text-muted-foreground",children:L?.name})]}),e.jsxs(z,{open:R,onOpenChange:d,children:[e.jsx($,{asChild:!0,children:e.jsxs(o,{children:[e.jsx(ne,{className:"mr-2 h-4 w-4"}),"Registrar Vacina"]})}),e.jsxs(G,{className:"max-w-2xl",children:[e.jsxs(U,{children:[e.jsx(J,{children:"Registrar Vacina"}),e.jsx(K,{children:"Adicione uma vacina aplicada ao hist√≥rico do pet"})]}),e.jsxs("form",{onSubmit:B,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"vaccineId",children:"Vacina *"}),e.jsxs(_,{name:"vaccineId",value:l?.toString()||"",onValueChange:a=>F(parseInt(a)),required:!0,children:[e.jsx(ee,{children:e.jsx(ae,{placeholder:"Selecione a vacina"})}),e.jsx(se,{children:D?.map(a=>e.jsx(ie,{value:a.id.toString(),children:a.name},a.id))})]}),l&&e.jsx("p",{className:"text-xs text-muted-foreground",children:D?.find(a=>a.id===l)?.description})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"applicationDate",children:"Data de Aplica√ß√£o *"}),e.jsx(t,{id:"applicationDate",name:"applicationDate",type:"date",defaultValue:new Date().toISOString().split("T")[0],required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"doseNumber",children:"N√∫mero da Dose"}),e.jsx(t,{id:"doseNumber",name:"doseNumber",type:"number",min:"1",placeholder:"Ex: 1, 2, 3"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"nextDueDate",children:"Pr√≥xima Dose"}),e.jsx(t,{id:"nextDueDate",name:"nextDueDate",type:"date"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Deixe em branco se for dose √∫nica"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"veterinarian",children:"Veterin√°rio"}),e.jsx(t,{id:"veterinarian",name:"veterinarian",placeholder:"Nome do veterin√°rio"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"clinic",children:"Cl√≠nica"}),e.jsx(t,{id:"clinic",name:"clinic",placeholder:"Nome da cl√≠nica"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"batchNumber",children:"Lote da Vacina"}),e.jsx(t,{id:"batchNumber",name:"batchNumber",placeholder:"N√∫mero do lote"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"notes",children:"Observa√ß√µes"}),e.jsx(Z,{id:"notes",name:"notes",rows:3,placeholder:"Rea√ß√µes, observa√ß√µes especiais, etc."})]}),e.jsxs(W,{children:[e.jsx(o,{type:"button",variant:"outline",onClick:()=>d(!1),children:"Cancelar"}),e.jsx(o,{type:"submit",disabled:m.isPending,children:m.isPending?"Salvando...":"Salvar"})]})]})]})]})]}),y.length>0&&e.jsxs(h,{className:"border-orange-200 bg-orange-50/50",children:[e.jsxs(u,{children:[e.jsxs(j,{className:"flex items-center gap-2 text-orange-700",children:[e.jsx(X,{className:"h-5 w-5"}),"Vacinas Pr√≥ximas"]}),e.jsx(I,{children:"Vacinas agendadas para os pr√≥ximos dias"})]}),e.jsx(g,{children:e.jsx("div",{className:"space-y-3",children:y.map(a=>{const s=Math.ceil((new Date(a.vaccination.nextDueDate).getTime()-x.getTime())/864e5);return e.jsxs("div",{className:"p-4 border border-orange-200 rounded-lg bg-white",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"font-semibold text-lg",children:a.vaccine.name}),e.jsx(A,{changes:f(a.vaccination.id),resourceType:"vaccine"})]}),a.vaccination.doseNumber&&e.jsxs(v,{variant:"outline",children:["Dose ",a.vaccination.doseNumber]})]}),e.jsx(v,{className:"bg-orange-100 text-orange-700 border-orange-200",children:s===0?"Hoje":s===1?"Amanh√£":`Em ${s} dias`})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Agendada para:"," ",new Date(a.vaccination.nextDueDate).toLocaleDateString("pt-BR",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]})]},a.vaccination.id)})})})]}),e.jsxs(h,{children:[e.jsxs(u,{children:[e.jsxs(j,{className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-5 w-5"}),"Hist√≥rico de Vacina√ß√£o"]}),e.jsx(I,{children:"Todas as vacinas aplicadas"})]}),e.jsx(g,{children:c?.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx(T,{className:"empty-state-icon"}),e.jsx("p",{className:"empty-state-title",children:"Nenhuma vacina registrada"}),e.jsx("p",{className:"empty-state-description",children:"Adicione as vacinas que o pet j√° recebeu"})]}):e.jsx("div",{className:"space-y-4",children:c?.map(a=>e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"font-semibold text-lg",children:a.vaccine.name}),e.jsx(A,{changes:f(a.vaccination.id),resourceType:"vaccine"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.vaccine.description}),a.vaccination.doseNumber&&e.jsxs(v,{variant:"outline",className:"mt-2",children:["Dose ",a.vaccination.doseNumber]})]})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm mt-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Aplica√ß√£o"}),e.jsx("p",{className:"font-medium",children:new Date(a.vaccination.applicationDate).toLocaleDateString("pt-BR")})]}),a.vaccination.nextDueDate&&e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Pr√≥xima Dose"}),e.jsx("p",{className:"font-medium",children:new Date(a.vaccination.nextDueDate).toLocaleDateString("pt-BR")})]}),a.vaccination.veterinarian&&e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Veterin√°rio"}),e.jsx("p",{className:"font-medium",children:a.vaccination.veterinarian})]}),a.vaccination.clinic&&e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Cl√≠nica"}),e.jsx("p",{className:"font-medium",children:a.vaccination.clinic})]})]}),a.vaccination.batchNumber&&e.jsxs("div",{className:"mt-3 p-2 bg-muted/30 rounded text-xs",children:[e.jsx("span",{className:"font-medium",children:"Lote:"})," ",a.vaccination.batchNumber]}),a.vaccination.notes&&e.jsx("div",{className:"mt-3 p-3 bg-muted/30 rounded",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:a.vaccination.notes})})]},a.vaccination.id))})})]}),e.jsxs(h,{className:"bg-blue-50/50 border-blue-200",children:[e.jsx(u,{children:e.jsx(j,{className:"text-base",children:"üí° Dicas de Vacina√ß√£o"})}),e.jsxs(g,{className:"text-sm space-y-2",children:[e.jsx("p",{children:"‚Ä¢ Mantenha a carteira de vacina√ß√£o sempre atualizada"}),e.jsx("p",{children:"‚Ä¢ Configure lembretes para as pr√≥ximas doses"}),e.jsx("p",{children:"‚Ä¢ Guarde os comprovantes e certificados de vacina√ß√£o"}),e.jsx("p",{children:"‚Ä¢ Observe o pet nas primeiras 24h ap√≥s a vacina√ß√£o"}),e.jsx("p",{children:"‚Ä¢ Consulte o veterin√°rio sobre o calend√°rio vacinal adequado"})]})]})]})})}export{Ce as default};
