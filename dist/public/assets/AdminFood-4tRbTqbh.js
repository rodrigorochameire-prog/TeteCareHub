import{r as h,t as j,a as g,j as e,l as A,o as M,A as K,B as k,p as I,q as O,s as $,v as Q,h as q,I as z,C as o,b as n,d as i,f as d,T as D,e as E}from"./index-DG0yx2hi.js";import{A as P}from"./AdminLayout-CapzJ-JK.js";import{T as H}from"./textarea-BfRN5q_Y.js";import{B as p}from"./popover-Bqiz4euq.js";import{P as U}from"./plus-DIKUpKHa.js";import{P as G}from"./package-CC5WVNv6.js";import{T as X}from"./trending-down-S1-mxyMB.js";import{S as f}from"./shopping-bag-B54fr_Tl.js";import"./scroll-area-C0S6gB82.js";import"./index-BdQq_4o_.js";import"./layout-dashboard-CC4g-mOh.js";import"./wallet-CKmMh37E.js";import"./users-DD1qYPM2.js";import"./user-B4BzRHVK.js";function de(){const[R,N]=h.useState(!1),[v,b]=h.useState(""),[y,w]=h.useState(""),{data:r,isLoading:L}=j.pets.list.useQuery(),{data:c,isLoading:T,refetch:B}=j.food.getStats.useQuery(),l=j.food.addStock.useMutation({onSuccess:()=>{g.success("Estoque atualizado com sucesso!"),N(!1),b(""),w(""),B()},onError:s=>{g.error("Erro ao atualizar estoque: "+s.message)}}),F=()=>{const s=parseFloat(v);if(isNaN(s)||s<=0){g.error("Por favor, insira uma quantidade válida.");return}l.mutate({amountKg:s,notes:y})},C=r?.reduce((s,u)=>s+(u.foodAmount||0),0)||0,m=C/1e3,S=c?.currentStockKg||0,x=m>0?Math.floor(S/m):0,a=x<7,t=x<25;return L||T?e.jsx(P,{children:e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx(A,{className:"w-8 h-8 animate-spin text-primary"})})}):e.jsx(P,{children:e.jsxs("div",{className:"container py-8 space-y-8 animate-fade-in",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Gestão de Ração"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Controle individual de ração por pet - cada tutor fornece a ração do seu pet"})]}),e.jsxs(M,{open:R,onOpenChange:N,children:[e.jsx(K,{asChild:!0,children:e.jsxs(k,{className:"gap-2",children:[e.jsx(U,{className:"w-4 h-4"}),"Adicionar Estoque"]})}),e.jsxs(I,{children:[e.jsxs(O,{children:[e.jsx($,{children:"Adicionar Estoque de Ração"}),e.jsx(Q,{children:"Registre a compra ou entrada de ração no estoque da creche"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(q,{htmlFor:"amount",children:"Quantidade (kg)"}),e.jsx(z,{id:"amount",type:"number",step:"0.1",placeholder:"Ex: 20.0",value:v,onChange:s=>b(s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(q,{htmlFor:"notes",children:"Observações (opcional)"}),e.jsx(H,{id:"notes",placeholder:"Ex: Compra da marca XYZ, nota fiscal 12345",value:y,onChange:s=>w(s.target.value),rows:3})]}),e.jsx(k,{onClick:F,disabled:l.isPending,className:"w-full",children:l.isPending?e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"w-4 h-4 mr-2 animate-spin"}),"Adicionando..."]}):"Adicionar ao Estoque"})]})]})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-3",children:[e.jsxs(o,{className:a?"border-red-200 bg-red-50/50":t?"border-orange-200 bg-orange-50/50":"",children:[e.jsxs(n,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(i,{className:"text-sm font-medium",children:"Estoque Atual"}),e.jsx(G,{className:`w-5 h-5 ${a?"text-red-600":t?"text-orange-600":"text-primary"}`})]}),e.jsxs(d,{children:[e.jsxs("div",{className:"text-3xl font-bold",children:[S.toFixed(1)," kg"]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[a&&e.jsxs(p,{variant:"destructive",className:"gap-1",children:[e.jsx(D,{className:"w-3 h-3"}),"Estoque crítico"]}),!a&&t&&e.jsxs(p,{className:"gap-1 bg-orange-100 text-orange-800 border-orange-300",children:[e.jsx(D,{className:"w-3 h-3"}),"Estoque baixo"]})]})]})]}),e.jsxs(o,{children:[e.jsxs(n,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(i,{className:"text-sm font-medium",children:"Consumo Diário"}),e.jsx(X,{className:"w-5 h-5 text-primary"})]}),e.jsxs(d,{children:[e.jsxs("div",{className:"text-3xl font-bold",children:[m.toFixed(1)," kg"]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:[C,"g total dos ",r?.length||0," pets"]})]})]}),e.jsxs(o,{className:a?"border-red-200 bg-red-50/50":t?"border-orange-200 bg-orange-50/50":"",children:[e.jsxs(n,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(i,{className:"text-sm font-medium",children:"Dias Restantes"}),e.jsx(f,{className:`w-5 h-5 ${a?"text-red-600":t?"text-orange-600":"text-primary"}`})]}),e.jsxs(d,{children:[e.jsx("div",{className:`text-3xl font-bold ${a?"text-red-600":t?"text-orange-600":""}`,children:x}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:a?"Comprar ração urgente!":t?"Programar compra em breve":"Estoque suficiente"})]})]})]}),e.jsxs(o,{children:[e.jsxs(n,{children:[e.jsx(i,{children:"Ração Individual por Pet"}),e.jsx(E,{children:"Cada pet tem sua própria ração (marca e quantidade) fornecida pelo tutor"})]}),e.jsx(d,{children:r&&r.length>0?e.jsx("div",{className:"space-y-3",children:r.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg border bg-card hover:bg-accent/5 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[s.photoUrl?e.jsx("img",{src:s.photoUrl,alt:s.name,className:"w-12 h-12 rounded-full object-cover border-2 border-primary/20"}):e.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(f,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:s.name}),e.jsx("div",{className:"text-sm text-muted-foreground",children:s.breed||"Raça não informada"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-bold text-lg",children:s.foodAmount?`${s.foodAmount}g`:"Não configurado"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"por dia"})]}),s.foodBrand&&e.jsx(p,{variant:"outline",className:"ml-2",children:s.foodBrand})]})]},s.id))}):e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(f,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"Nenhum pet cadastrado ainda"})]})})]}),c?.recentMovements&&c.recentMovements.length>0&&e.jsxs(o,{children:[e.jsxs(n,{children:[e.jsx(i,{children:"Movimentações Recentes"}),e.jsx(E,{children:"Últimas entradas de estoque registradas"})]}),e.jsx(d,{children:e.jsx("div",{className:"space-y-3",children:c.recentMovements.map((s,u)=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:["+",s.amountKg,"kg"]}),s.notes&&e.jsx("div",{className:"text-sm text-muted-foreground",children:s.notes})]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:new Date(s.createdAt).toLocaleDateString("pt-BR")})]},u))})})]})]})})}export{de as default};
