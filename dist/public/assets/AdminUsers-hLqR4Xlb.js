import{m as V,r as l,t as d,a as r,j as e,o as y,A as J,B as i,p as b,q as w,s as D,v as E,h as S,I as K,w as T,C as x,b as h,d as u,f as j,e as W,S as X}from"./index-DG0yx2hi.js";import{A as Y}from"./AdminLayout-CapzJ-JK.js";import{B as k}from"./popover-Bqiz4euq.js";import{T as Z,a as _,b as R,c as t,d as ee,e as o}from"./table-DeOYaLOA.js";import{M as se}from"./mail-DVbdA7bp.js";import{U as ae}from"./users-DD1qYPM2.js";import{U as ie}from"./user-plus-DWTF4nUO.js";import{T as re}from"./trash-2-6I2MbiK3.js";import{f as A,p as I}from"./pt-BR-BIS3WgEC.js";import"./scroll-area-C0S6gB82.js";import"./index-BdQq_4o_.js";import"./layout-dashboard-CC4g-mOh.js";import"./wallet-CKmMh37E.js";import"./user-B4BzRHVK.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=V("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);function Ce(){const[a,P]=l.useState(null),[z,c]=l.useState(!1),[O,m]=l.useState(!1),[B,p]=l.useState(!1),[v,U]=l.useState(""),{data:n,isLoading:H,refetch:M}=d.userManagement.list.useQuery(),{data:f}=d.adminInvites.list.useQuery(),g=d.userManagement.updateRole.useMutation({onSuccess:()=>{r.success("Função do usuário atualizada com sucesso!"),c(!1),M()},onError:s=>{r.error("Erro ao atualizar função: "+s.message)}}),C=d.adminInvites.create.useMutation({onSuccess:s=>{r.success("Convite enviado com sucesso!"),r.info("Link do convite copiado para a área de transferência"),navigator.clipboard.writeText(s.inviteUrl),p(!1),U("")},onError:s=>{r.error("Erro ao enviar convite: "+s.message)}}),N=d.userManagement.delete.useMutation({onSuccess:()=>{r.success("Usuário removido com sucesso!"),m(!1),M()},onError:s=>{r.error("Erro ao remover usuário: "+s.message)}}),L=s=>{P(s),c(!0)},q=s=>{P(s),m(!0)},F=()=>{if(!a)return;const s=a.role==="admin"?"user":"admin";g.mutate({userId:a.id,role:s})},G=()=>{a&&N.mutate({userId:a.id})},Q=n?.filter(s=>s.role==="admin").length||0,$=n?.filter(s=>s.role==="user").length||0;return e.jsx(Y,{children:e.jsxs("div",{className:"container max-w-7xl py-8 space-y-8 animate-fade-in",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Gestão de Usuários"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Gerencie administradores e usuários da plataforma"})]}),e.jsxs(y,{open:B,onOpenChange:p,children:[e.jsx(J,{asChild:!0,children:e.jsxs(i,{children:[e.jsx(se,{className:"mr-2 h-4 w-4"}),"Convidar Admin"]})}),e.jsxs(b,{children:[e.jsxs(w,{children:[e.jsx(D,{children:"Convidar Novo Administrador"}),e.jsx(E,{children:"Envie um convite por email para adicionar um novo administrador"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{htmlFor:"invite-email",children:"Email"}),e.jsx(K,{id:"invite-email",type:"email",placeholder:"admin@exemplo.com",value:v,onChange:s=>U(s.target.value)})]}),f&&f.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{children:"Convites Pendentes"}),e.jsx("div",{className:"space-y-1",children:f.map(s=>e.jsxs("div",{className:"text-sm text-muted-foreground",children:[s.email," - Expira em ",A(new Date(s.expiresAt),"dd/MM/yyyy",{locale:I})]},s.id))})]})]}),e.jsxs(T,{children:[e.jsx(i,{variant:"outline",onClick:()=>p(!1),children:"Cancelar"}),e.jsx(i,{onClick:()=>C.mutate({email:v}),disabled:!v||C.isPending,children:C.isPending?"Enviando...":"Enviar Convite"})]})]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsxs(x,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:"Total de Usuários"}),e.jsx(ae,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(j,{children:e.jsx("div",{className:"text-2xl font-bold",children:n?.length||0})})]}),e.jsxs(x,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:"Administradores"}),e.jsx(ne,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(j,{children:e.jsx("div",{className:"text-2xl font-bold",children:Q})})]}),e.jsxs(x,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:"Usuários Comuns"}),e.jsx(ie,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(j,{children:e.jsx("div",{className:"text-2xl font-bold",children:$})})]})]}),e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsx(u,{children:"Todos os Usuários"}),e.jsx(W,{children:"Lista completa de usuários cadastrados na plataforma"})]}),e.jsx(j,{children:H?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Carregando usuários..."}):!n||n.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Nenhum usuário encontrado"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Z,{children:[e.jsx(_,{children:e.jsxs(R,{children:[e.jsx(t,{children:"Nome"}),e.jsx(t,{children:"Email"}),e.jsx(t,{children:"Função"}),e.jsx(t,{children:"Último Acesso"}),e.jsx(t,{children:"Cadastrado em"}),e.jsx(t,{className:"text-right",children:"Ações"})]})}),e.jsx(ee,{children:n.map(s=>e.jsxs(R,{children:[e.jsx(o,{className:"font-medium",children:s.name}),e.jsx(o,{children:s.email}),e.jsx(o,{children:s.role==="admin"?e.jsxs(k,{variant:"default",className:"gap-1",children:[e.jsx(X,{className:"h-3 w-3"}),"Administrador"]}):e.jsx(k,{variant:"secondary",children:"Usuário"})}),e.jsx(o,{children:s.lastSignedIn?A(new Date(s.lastSignedIn),"dd/MM/yyyy HH:mm",{locale:I}):"-"}),e.jsx(o,{children:A(new Date(s.createdAt),"dd/MM/yyyy",{locale:I})}),e.jsx(o,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(i,{variant:"outline",size:"sm",onClick:()=>L(s),children:s.role==="admin"?"Remover Admin":"Promover a Admin"}),e.jsx(i,{variant:"destructive",size:"sm",onClick:()=>q(s),children:e.jsx(re,{className:"h-4 w-4"})})]})})]},s.id))})]})})})]}),e.jsx(y,{open:z,onOpenChange:c,children:e.jsxs(b,{children:[e.jsxs(w,{children:[e.jsx(D,{children:a?.role==="admin"?"Remover Privilégios de Admin":"Promover a Administrador"}),e.jsx(E,{children:a?.role==="admin"?`Tem certeza que deseja remover os privilégios de administrador de ${a?.name}? Eles voltarão a ser um usuário comum.`:`Tem certeza que deseja promover ${a?.name} a administrador? Eles terão acesso total ao sistema.`})]}),e.jsxs(T,{children:[e.jsx(i,{variant:"outline",onClick:()=>c(!1),children:"Cancelar"}),e.jsx(i,{onClick:F,disabled:g.isPending,children:g.isPending?"Processando...":"Confirmar"})]})]})}),e.jsx(y,{open:O,onOpenChange:m,children:e.jsxs(b,{children:[e.jsxs(w,{children:[e.jsx(D,{children:"Remover Usuário"}),e.jsxs(E,{children:["Tem certeza que deseja remover ",a?.name,"? Esta ação não pode ser desfeita."]})]}),e.jsxs(T,{children:[e.jsx(i,{variant:"outline",onClick:()=>m(!1),children:"Cancelar"}),e.jsx(i,{variant:"destructive",onClick:G,disabled:N.isPending,children:N.isPending?"Removendo...":"Remover"})]})]})})]})})}export{Ce as default};
