import{r as x,t as o,a as l,j as e,C as r,b as i,d as n,e as u,B as d,f as c,n as W,i as G,I as m,o as P,p as S,q as A,s as F,v as I,h as t,w as R}from"./index-DG0yx2hi.js";import{A as Ne}from"./AdminLayout-CapzJ-JK.js";import{B as p}from"./popover-Bqiz4euq.js";import{T as E}from"./textarea-BfRN5q_Y.js";import{T as ye,a as be,b as k,c as L}from"./tabs-sUy1g-fW.js";import{S as q,a as O,b as M,c as B,d as y}from"./select-k5kl2mY3.js";import{T as Ce,a as we,b as K,c as b,d as Te,e as C}from"./table-DeOYaLOA.js";import{A as De,a as J,P as Pe}from"./PaymentHistory-BXC4X_EU.js";import{W as Se}from"./wallet-CKmMh37E.js";import{P as Ae}from"./package-CC5WVNv6.js";import{C as V}from"./credit-card-CxD7Buqp.js";import{T as X}from"./trending-up-C2VanZIM.js";import{P as Q}from"./plus-DIKUpKHa.js";import{S as Fe}from"./square-pen-D7F5zf6L.js";import{T as Ie}from"./trash-2-6I2MbiK3.js";import{U as Re}from"./users-DD1qYPM2.js";import{D as Ee}from"./layout-dashboard-CC4g-mOh.js";import{R as ke,L as Le,C as qe,X as Oe,Y as Me,T as Be,a as Ve}from"./LineChart-CD6pLqis.js";import"./scroll-area-C0S6gB82.js";import"./index-BdQq_4o_.js";import"./user-B4BzRHVK.js";import"./index-r4-iOF84.js";import"./chevron-down-CKVtRMqG.js";import"./check-DDByOptX.js";import"./circle-x-Ewhe70CR.js";import"./clock-BQzFMz2h.js";import"./pt-BR-BIS3WgEC.js";import"./findIndex-Ckvz6Jh7.js";function bs(){const[Y,Z]=x.useState("plans"),[_,f]=x.useState(!1),[Qe,$]=x.useState(!1),[ee,g]=x.useState(!1),[se,v]=x.useState(!1),[$e,z]=x.useState(null),[w,H]=x.useState(""),[ze,He]=x.useState("income"),[U,ae]=x.useState(""),{data:te,isLoading:Ue}=o.plans.list.useQuery(),{data:j,isLoading:We}=o.pets.list.useQuery(),{data:N,isLoading:Ge}=o.credits.getStats.useQuery(),{data:re}=o.credits.getTransactions.useQuery(),h=o.useUtils(),ie=o.plans.create.useMutation({onSuccess:()=>{l.success("Plano criado com sucesso!"),h.plans.list.invalidate(),f(!1)},onError:s=>{l.error("Erro ao criar plano: "+s.message)}});o.plans.update.useMutation({onSuccess:()=>{l.success("Plano atualizado com sucesso!"),h.plans.list.invalidate(),$(!1),z(null)},onError:s=>{l.error("Erro ao atualizar plano: "+s.message)}});const ne=o.plans.delete.useMutation({onSuccess:()=>{l.success("Plano removido com sucesso!"),h.plans.list.invalidate()},onError:s=>{l.error("Erro ao remover plano: "+s.message)}}),ce=o.credits.addPackage.useMutation({onSuccess:()=>{l.success("Créditos adicionados com sucesso!"),g(!1),H(""),h.pets.list.invalidate(),h.credits.getStats.invalidate()},onError:s=>{l.error("Erro ao adicionar créditos: "+s.message)}}),le=o.credits.addTransaction.useMutation({onSuccess:()=>{l.success("Transação registrada com sucesso!"),v(!1),h.credits.getTransactions.invalidate(),h.credits.getStats.invalidate()},onError:s=>{l.error(s.message)}}),de=s=>{s.preventDefault();const a=new FormData(s.currentTarget);ie.mutate({name:a.get("name"),description:a.get("description"),price:parseInt(a.get("price"))*100,credits:parseInt(a.get("credits")),validityDays:parseInt(a.get("validityDays")),benefits:a.get("benefits")})},oe=s=>{confirm("Tem certeza que deseja remover este plano?")&&ne.mutate({id:s})},xe=s=>{if(s.preventDefault(),!w){l.error("Selecione um pet");return}const a=new FormData(s.currentTarget),T=Number(a.get("days")),D=Number(a.get("price"));ce.mutate({petId:parseInt(w),packageDays:T,packagePrice:D})},me=s=>{s.preventDefault();const a=new FormData(s.currentTarget),T=a.get("petId")?parseInt(a.get("petId")):void 0,D=parseFloat(a.get("amount")),fe=a.get("type"),ge=a.get("category"),ve=a.get("description");le.mutate({petId:T,amount:D,type:fe,category:ge,description:ve})},he=j?.filter(s=>s.name.toLowerCase().includes(U.toLowerCase()))||[],je=j?.reduce((s,a)=>s+(a.credits||0),0)||0,ue=j?.filter(s=>(s.credits||0)<5).length||0,pe=[{month:"Jan",revenue:12500},{month:"Fev",revenue:15200},{month:"Mar",revenue:18900},{month:"Abr",revenue:16700},{month:"Mai",revenue:21300},{month:"Jun",revenue:19800}];return e.jsx(Ne,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-3",children:[e.jsx(Se,{className:"h-8 w-8 text-primary"}),"Pacotes & Financeiro"]}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Gerencie planos de assinatura, créditos e finanças da creche"})]})}),e.jsxs(ye,{value:Y,onValueChange:Z,className:"space-y-6",children:[e.jsxs(be,{className:"grid w-full grid-cols-3 lg:w-auto",children:[e.jsxs(k,{value:"plans",className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"h-4 w-4"}),"Planos"]}),e.jsxs(k,{value:"credits",className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-4 w-4"}),"Créditos"]}),e.jsxs(k,{value:"finances",className:"flex items-center gap-2",children:[e.jsx(X,{className:"h-4 w-4"}),"Financeiro"]})]}),e.jsx(L,{value:"plans",className:"space-y-4",children:e.jsxs(r,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Planos de Assinatura"}),e.jsx(u,{children:"Configure e gerencie os planos disponíveis para os tutores"})]}),e.jsxs(d,{onClick:()=>f(!0),children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),"Novo Plano"]})]}),e.jsx(c,{children:e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:te?.map(s=>e.jsxs(r,{className:"relative",children:[e.jsxs(i,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(n,{className:"text-xl",children:s.name}),s.isActive?e.jsx(p,{children:"Ativo"}):e.jsx(p,{variant:"secondary",children:"Inativo"})]}),e.jsx(u,{children:s.description})]}),e.jsxs(c,{className:"space-y-4",children:[e.jsxs("div",{className:"text-3xl font-bold",children:["R$ ",(s.price/100).toFixed(2)]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{children:[s.credits," créditos"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{children:["Válido por ",s.validityDays," dias"]})]})]}),s.benefits&&e.jsx("div",{className:"pt-4 border-t",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:s.benefits})}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx(d,{size:"sm",variant:"outline",onClick:()=>{z(s),$(!0)},children:e.jsx(Fe,{className:"h-4 w-4"})}),e.jsx(d,{size:"sm",variant:"outline",onClick:()=>oe(s.id),children:e.jsx(Ie,{className:"h-4 w-4 text-destructive"})})]})]})]},s.id))})})]})}),e.jsxs(L,{value:"credits",className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(r,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(n,{className:"text-sm font-medium",children:"Total de Créditos"}),e.jsx(V,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:je}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Em todos os pets ativos"})]})]}),e.jsxs(r,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(n,{className:"text-sm font-medium",children:"Créditos Baixos"}),e.jsx(G,{className:"h-4 w-4 text-yellow-500"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:ue}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Pets com menos de 5 créditos"})]})]}),e.jsxs(r,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(n,{className:"text-sm font-medium",children:"Pets Ativos"}),e.jsx(Re,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:j?.length||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total de pets cadastrados"})]})]})]}),e.jsxs(r,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Gerenciar Créditos"}),e.jsx(u,{children:"Adicione ou ajuste os créditos dos pets"})]}),e.jsxs(d,{onClick:()=>g(!0),children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),"Adicionar Créditos"]})]}),e.jsxs(c,{className:"space-y-4",children:[e.jsx(m,{placeholder:"Buscar pet...",value:U,onChange:s=>ae(s.target.value)}),e.jsx("div",{className:"rounded-lg border",children:e.jsxs(Ce,{children:[e.jsx(we,{children:e.jsxs(K,{children:[e.jsx(b,{children:"Pet"}),e.jsx(b,{children:"Tutor"}),e.jsx(b,{children:"Créditos"}),e.jsx(b,{children:"Status"})]})}),e.jsx(Te,{children:he.map(s=>e.jsxs(K,{children:[e.jsx(C,{className:"font-medium",children:s.name}),e.jsx(C,{children:s.tutorName||"N/A"}),e.jsx(C,{children:e.jsx(p,{variant:s.credits>10?"default":s.credits>5?"secondary":"destructive",children:s.credits||0})}),e.jsx(C,{children:s.credits<5?e.jsxs(p,{variant:"outline",className:"text-yellow-600",children:[e.jsx(G,{className:"h-3 w-3 mr-1"}),"Baixo"]}):e.jsx(p,{variant:"outline",className:"text-green-600",children:"OK"})})]},s.id))})]})})]})]})]}),e.jsxs(L,{value:"finances",className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(r,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(n,{className:"text-sm font-medium",children:"Receita Mensal"}),e.jsx(X,{className:"h-4 w-4 text-green-500"})]}),e.jsxs(c,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["R$ ",N?.totalRevenue?.toFixed(2)||"0.00"]}),e.jsxs("p",{className:"text-xs text-green-600 flex items-center gap-1",children:[e.jsx(De,{className:"h-3 w-3"}),"+12.5% em relação ao mês anterior"]})]})]}),e.jsxs(r,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(n,{className:"text-sm font-medium",children:"Despesas"}),e.jsx(J,{className:"h-4 w-4 text-red-500"})]}),e.jsxs(c,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["R$ ",N?.totalExpenses?.toFixed(2)||"0.00"]}),e.jsxs("p",{className:"text-xs text-red-600 flex items-center gap-1",children:[e.jsx(J,{className:"h-3 w-3"}),"+5.2% em relação ao mês anterior"]})]})]}),e.jsxs(r,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(n,{className:"text-sm font-medium",children:"Lucro Líquido"}),e.jsx(Ee,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["R$ ",((N?.totalRevenue||0)-(N?.totalExpenses||0)).toFixed(2)]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Margem de lucro"})]})]}),e.jsxs(r,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(n,{className:"text-sm font-medium",children:"Transações"}),e.jsx(W,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:re?.length||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Este mês"})]})]})]}),e.jsxs(r,{children:[e.jsxs(i,{children:[e.jsx(n,{children:"Receita Mensal"}),e.jsx(u,{children:"Visão geral dos últimos 6 meses"})]}),e.jsx(c,{children:e.jsx(ke,{width:"100%",height:300,children:e.jsxs(Le,{data:pe,children:[e.jsx(qe,{strokeDasharray:"3 3"}),e.jsx(Oe,{dataKey:"month"}),e.jsx(Me,{}),e.jsx(Be,{}),e.jsx(Ve,{type:"monotone",dataKey:"revenue",stroke:"#8884d8",strokeWidth:2})]})})})]}),e.jsxs(r,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Histórico de Transações"}),e.jsx(u,{children:"Visualize e gerencie todas as transações financeiras"})]}),e.jsxs(d,{onClick:()=>v(!0),children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),"Nova Transação"]})]}),e.jsx(c,{children:e.jsx(Pe,{})})]})]})]}),e.jsx(P,{open:_,onOpenChange:f,children:e.jsxs(S,{children:[e.jsxs(A,{children:[e.jsx(F,{children:"Criar Novo Plano"}),e.jsx(I,{children:"Configure um novo plano de assinatura"})]}),e.jsxs("form",{onSubmit:de,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"name",children:"Nome do Plano"}),e.jsx(m,{id:"name",name:"name",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"description",children:"Descrição"}),e.jsx(E,{id:"description",name:"description",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"price",children:"Preço (R$)"}),e.jsx(m,{id:"price",name:"price",type:"number",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"credits",children:"Créditos"}),e.jsx(m,{id:"credits",name:"credits",type:"number",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"validityDays",children:"Validade (dias)"}),e.jsx(m,{id:"validityDays",name:"validityDays",type:"number",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"benefits",children:"Benefícios"}),e.jsx(E,{id:"benefits",name:"benefits"})]}),e.jsxs(R,{children:[e.jsx(d,{type:"button",variant:"outline",onClick:()=>f(!1),children:"Cancelar"}),e.jsx(d,{type:"submit",children:"Criar Plano"})]})]})]})}),e.jsx(P,{open:ee,onOpenChange:g,children:e.jsxs(S,{children:[e.jsxs(A,{children:[e.jsx(F,{children:"Adicionar Créditos"}),e.jsx(I,{children:"Adicione créditos para um pet específico"})]}),e.jsxs("form",{onSubmit:xe,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"petId",children:"Pet"}),e.jsxs(q,{value:w,onValueChange:H,required:!0,children:[e.jsx(O,{children:e.jsx(M,{placeholder:"Selecione um pet"})}),e.jsx(B,{children:j?.map(s=>e.jsx(y,{value:s.id.toString(),children:s.name},s.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"days",children:"Quantidade de Créditos"}),e.jsx(m,{id:"days",name:"days",type:"number",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"price",children:"Valor Pago (R$)"}),e.jsx(m,{id:"price",name:"price",type:"number",step:"0.01",required:!0})]}),e.jsxs(R,{children:[e.jsx(d,{type:"button",variant:"outline",onClick:()=>g(!1),children:"Cancelar"}),e.jsx(d,{type:"submit",children:"Adicionar"})]})]})]})}),e.jsx(P,{open:se,onOpenChange:v,children:e.jsxs(S,{children:[e.jsxs(A,{children:[e.jsx(F,{children:"Registrar Transação"}),e.jsx(I,{children:"Adicione uma nova transação financeira"})]}),e.jsxs("form",{onSubmit:me,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"type",children:"Tipo"}),e.jsxs(q,{name:"type",required:!0,children:[e.jsx(O,{children:e.jsx(M,{placeholder:"Selecione o tipo"})}),e.jsxs(B,{children:[e.jsx(y,{value:"income",children:"Receita"}),e.jsx(y,{value:"expense",children:"Despesa"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"amount",children:"Valor (R$)"}),e.jsx(m,{id:"amount",name:"amount",type:"number",step:"0.01",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"category",children:"Categoria"}),e.jsx(m,{id:"category",name:"category",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"description",children:"Descrição"}),e.jsx(E,{id:"description",name:"description",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"petId",children:"Pet (opcional)"}),e.jsxs(q,{name:"petId",children:[e.jsx(O,{children:e.jsx(M,{placeholder:"Selecione um pet (opcional)"})}),e.jsx(B,{children:j?.map(s=>e.jsx(y,{value:s.id.toString(),children:s.name},s.id))})]})]}),e.jsxs(R,{children:[e.jsx(d,{type:"button",variant:"outline",onClick:()=>v(!1),children:"Cancelar"}),e.jsx(d,{type:"submit",children:"Registrar"})]})]})]})})]})})}export{bs as default};
