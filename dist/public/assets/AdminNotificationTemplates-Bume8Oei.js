import{r as b,t as x,j as e,o as y,A as L,B as l,p as T,q as C,s as w,v as A,h as t,I as u,C as d,b as h,d as p,z as D,f as o,X as B,e as H,a as c}from"./index-DG0yx2hi.js";import{A as V}from"./AdminLayout-CapzJ-JK.js";import{T as S}from"./textarea-BfRN5q_Y.js";import{S as k}from"./switch-DwIsyt3g.js";import{B as E}from"./popover-Bqiz4euq.js";import{P as J}from"./plus-DIKUpKHa.js";import{I as R}from"./info-DReA-lTp.js";import{C as U}from"./check-DDByOptX.js";import{S as Q}from"./square-pen-D7F5zf6L.js";import{T as X}from"./trash-2-6I2MbiK3.js";import"./scroll-area-C0S6gB82.js";import"./index-BdQq_4o_.js";import"./layout-dashboard-CC4g-mOh.js";import"./wallet-CKmMh37E.js";import"./users-DD1qYPM2.js";import"./user-B4BzRHVK.js";import"./index-r4-iOF84.js";const F=[{value:"vaccine_reminder_7d",label:"Lembrete de Vacina (7 dias)",variables:["{{petName}}","{{vaccineName}}","{{dueDate}}","{{tutorName}}"]},{value:"vaccine_reminder_1d",label:"Lembrete de Vacina (1 dia)",variables:["{{petName}}","{{vaccineName}}","{{dueDate}}","{{tutorName}}"]},{value:"medication_reminder",label:"Lembrete de Medicamento",variables:["{{petName}}","{{medicationName}}","{{dosage}}","{{time}}","{{tutorName}}"]},{value:"checkin_notification",label:"Notificação de Check-in",variables:["{{petName}}","{{time}}","{{tutorName}}"]},{value:"checkout_notification",label:"Notificação de Check-out",variables:["{{petName}}","{{time}}","{{tutorName}}"]},{value:"daily_report",label:"Relatório Diário",variables:["{{petName}}","{{date}}","{{mood}}","{{activities}}","{{tutorName}}"]},{value:"credits_low",label:"Créditos Baixos",variables:["{{petName}}","{{remainingCredits}}","{{tutorName}}"]},{value:"event_reminder",label:"Lembrete de Evento",variables:["{{petName}}","{{eventTitle}}","{{eventDate}}","{{tutorName}}"]}];function me(){const[r,j]=b.useState(null),[I,v]=b.useState(!1),[_,m]=b.useState(!1),{data:n,isLoading:M,refetch:f}=x.notificationTemplates.getAll.useQuery(),N=x.notificationTemplates.create.useMutation(),g=x.notificationTemplates.update.useMutation(),O=x.notificationTemplates.delete.useMutation(),q=async a=>{a.preventDefault();const s=new FormData(a.currentTarget);try{await N.mutateAsync({type:s.get("type"),title:s.get("title"),message:s.get("message"),availableVariables:s.get("availableVariables"),isActive:s.get("isActive")==="on"}),c.success("Template criado com sucesso!"),v(!1),f()}catch(i){c.error(i.message||"Erro ao criar template")}},z=async a=>{a.preventDefault();const s=new FormData(a.currentTarget);try{await g.mutateAsync({id:r.id,title:s.get("title"),message:s.get("message"),availableVariables:s.get("availableVariables"),isActive:s.get("isActive")==="on"}),c.success("Template atualizado com sucesso!"),m(!1),j(null),f()}catch(i){c.error(i.message||"Erro ao atualizar template")}},P=async a=>{if(confirm("Tem certeza que deseja excluir este template?"))try{await O.mutateAsync({id:a}),c.success("Template excluído com sucesso!"),f()}catch(s){c.error(s.message||"Erro ao excluir template")}};return M?e.jsx(V,{children:e.jsx("div",{className:"container max-w-7xl py-8 animate-fade-in",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("p",{className:"text-muted-foreground",children:"Carregando templates..."})})})}):e.jsx(V,{children:e.jsxs("div",{className:"container max-w-7xl py-8 animate-fade-in",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Templates de Notificações"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Personalize as mensagens automáticas enviadas aos tutores"})]}),e.jsxs(y,{open:I,onOpenChange:v,children:[e.jsx(L,{asChild:!0,children:e.jsxs(l,{children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Novo Template"]})}),e.jsxs(T,{className:"max-w-2xl",children:[e.jsxs(C,{children:[e.jsx(w,{children:"Criar Novo Template"}),e.jsx(A,{children:"Crie um template de notificação personalizado"})]}),e.jsxs("form",{onSubmit:q,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"type",children:"Tipo de Notificação"}),e.jsxs("select",{id:"type",name:"type",required:!0,className:"w-full px-3 py-2 border border-input rounded-md bg-background",children:[e.jsx("option",{value:"",children:"Selecione um tipo"}),F.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"title",children:"Título"}),e.jsx(u,{id:"title",name:"title",required:!0,placeholder:"Ex: Lembrete de Vacina"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"message",children:"Mensagem"}),e.jsx(S,{id:"message",name:"message",required:!0,rows:6,placeholder:"Use variáveis como {{petName}}, {{date}}, etc."}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.jsx(R,{className:"inline h-3 w-3 mr-1"}),"Variáveis disponíveis serão substituídas automaticamente"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"availableVariables",children:"Variáveis Disponíveis (JSON)"}),e.jsx(u,{id:"availableVariables",name:"availableVariables",placeholder:'["{{petName}}", "{{date}}"]'})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(k,{id:"isActive",name:"isActive",defaultChecked:!0}),e.jsx(t,{htmlFor:"isActive",children:"Template ativo"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(l,{type:"button",variant:"outline",onClick:()=>v(!1),children:"Cancelar"}),e.jsx(l,{type:"submit",disabled:N.isPending,children:N.isPending?"Criando...":"Criar Template"})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsxs(d,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(p,{className:"text-sm font-medium",children:"Total de Templates"}),e.jsx(D,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(o,{children:e.jsx("div",{className:"text-2xl font-bold",children:n?.length||0})})]}),e.jsxs(d,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(p,{className:"text-sm font-medium",children:"Templates Ativos"}),e.jsx(U,{className:"h-4 w-4 text-green-600"})]}),e.jsx(o,{children:e.jsx("div",{className:"text-2xl font-bold",children:n?.filter(a=>a.isActive).length||0})})]}),e.jsxs(d,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(p,{className:"text-sm font-medium",children:"Templates Inativos"}),e.jsx(B,{className:"h-4 w-4 text-red-600"})]}),e.jsx(o,{children:e.jsx("div",{className:"text-2xl font-bold",children:n?.filter(a=>!a.isActive).length||0})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[n&&n.length===0&&e.jsx(d,{children:e.jsxs(o,{className:"flex flex-col items-center justify-center h-64",children:[e.jsx(D,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsxs("p",{className:"text-muted-foreground text-center",children:["Nenhum template cadastrado ainda.",e.jsx("br",{}),'Clique em "Novo Template" para começar.']})]})}),n?.map(a=>{const s=F.find(i=>i.value===a.type);return e.jsxs(d,{className:"hover-lift",children:[e.jsx(h,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{children:a.title}),e.jsx(E,{variant:a.isActive?"default":"secondary",children:a.isActive?"Ativo":"Inativo"})]}),e.jsx(H,{children:s?.label||a.type})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{variant:"outline",size:"sm",onClick:()=>{j(a),m(!0)},children:e.jsx(Q,{className:"h-4 w-4"})}),e.jsx(l,{variant:"outline",size:"sm",onClick:()=>P(a.id),children:e.jsx(X,{className:"h-4 w-4 text-red-600"})})]})]})}),e.jsx(o,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(t,{className:"text-sm font-medium",children:"Mensagem:"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground whitespace-pre-wrap",children:a.message})]}),s&&e.jsxs("div",{children:[e.jsx(t,{className:"text-sm font-medium",children:"Variáveis disponíveis:"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:s.variables.map(i=>e.jsx(E,{variant:"outline",children:i},i))})]})]})})]},a.id)})]}),r&&e.jsx(y,{open:_,onOpenChange:m,children:e.jsxs(T,{className:"max-w-2xl",children:[e.jsxs(C,{children:[e.jsx(w,{children:"Editar Template"}),e.jsx(A,{children:"Atualize o template de notificação"})]}),e.jsxs("form",{onSubmit:z,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"edit-title",children:"Título"}),e.jsx(u,{id:"edit-title",name:"title",required:!0,defaultValue:r.title})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"edit-message",children:"Mensagem"}),e.jsx(S,{id:"edit-message",name:"message",required:!0,rows:6,defaultValue:r.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"edit-availableVariables",children:"Variáveis Disponíveis (JSON)"}),e.jsx(u,{id:"edit-availableVariables",name:"availableVariables",defaultValue:r.availableVariables||""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(k,{id:"edit-isActive",name:"isActive",defaultChecked:r.isActive}),e.jsx(t,{htmlFor:"edit-isActive",children:"Template ativo"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(l,{type:"button",variant:"outline",onClick:()=>{m(!1),j(null)},children:"Cancelar"}),e.jsx(l,{type:"submit",disabled:g.isPending,children:g.isPending?"Salvando...":"Salvar Alterações"})]})]})]})})]})})}export{me as default};
