import{t as n,r,a as o,j as e,C as c,f as m,af as x,b as S,d as M,o as V,A as B,B as A,p as Q,q as $,s as q,h as u,e as F,n as z}from"./index-DG0yx2hi.js";import{T as R}from"./TutorLayout-lMG2oLBz.js";import{T as G}from"./textarea-BfRN5q_Y.js";import{M as J}from"./message-square-COhalQ2E.js";import{f as h,p as K}from"./pt-BR-BIS3WgEC.js";import"./popover-Bqiz4euq.js";import"./NotificationBell-BIuiN9Fe.js";import"./info-DReA-lTp.js";import"./chart-column-B4FPjduw.js";import"./package-CC5WVNv6.js";import"./user-B4BzRHVK.js";function ie(){const{data:T=[],isLoading:P}=n.pets.list.useQuery(),p=T,[a,E]=r.useState(null),[i,j]=r.useState(0),[I,g]=r.useState(0),[f,v]=r.useState(""),[N,b]=r.useState(new Date().toISOString().split("T")[0]),[O,y]=r.useState(!1),w=p.find(s=>s.id===a),{data:C=[],refetch:k}=n.reviews.list.useQuery({petId:a??void 0},{enabled:!!a}),{data:H=0}=n.reviews.getAverageRating.useQuery(),d=n.reviews.create.useMutation({onSuccess:()=>{o.success("AvaliaÃ§Ã£o enviada com sucesso!"),j(0),v(""),b(new Date().toISOString().split("T")[0]),y(!1),k()},onError:s=>{o.error("Erro ao enviar avaliaÃ§Ã£o: "+s.message)}}),L=()=>{if(!a||i===0){o.error("Selecione um pet e uma avaliaÃ§Ã£o");return}d.mutate({petId:a,rating:i,comment:f,visitDate:new Date(N)})},D=(s,t=!1)=>e.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(l=>e.jsx("button",{type:"button",disabled:!t,onClick:()=>t&&j(l),onMouseEnter:()=>t&&g(l),onMouseLeave:()=>t&&g(0),className:`transition-colors ${t?"cursor-pointer":"cursor-default"}`,children:e.jsx(x,{className:`h-6 w-6 ${l<=(t?I||i:s)?"fill-yellow-400 text-yellow-400":"text-gray-300"}`})},l))});return P?e.jsx(R,{children:e.jsx("div",{className:"flex items-center justify-center h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})})}):e.jsx(R,{children:e.jsxs("div",{className:"container max-w-6xl py-8 animate-fade-in",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"AvaliaÃ§Ãµes e Feedback"}),e.jsx("p",{className:"text-muted-foreground",children:"Compartilhe sua experiÃªncia e ajude a melhorar nossos serviÃ§os"})]}),e.jsx(c,{className:"mb-6",children:e.jsx(m,{className:"pt-6",children:e.jsx("div",{className:"flex items-center justify-center gap-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"AvaliaÃ§Ã£o MÃ©dia da Creche"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-4xl font-bold",children:H.toFixed(1)}),e.jsx(x,{className:"h-8 w-8 fill-yellow-400 text-yellow-400"})]})]})})})}),e.jsxs(c,{className:"mb-6",children:[e.jsx(S,{children:e.jsx(M,{children:"Selecione o Pet"})}),e.jsx(m,{children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:p.map(s=>e.jsx("button",{onClick:()=>E(s.id),className:`p-4 rounded-lg border-2 transition-all ${a===s.id?"border-primary bg-primary/10":"border-border hover:border-primary/50"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl mb-2",children:"ðŸ•"}),e.jsx("p",{className:"font-semibold",children:s.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.breed})]})},s.id))})})]}),w&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(V,{open:O,onOpenChange:y,children:[e.jsx(B,{asChild:!0,children:e.jsxs(A,{className:"w-full",size:"lg",children:[e.jsx(x,{className:"mr-2 h-5 w-5"}),"Avaliar Visita"]})}),e.jsxs(Q,{className:"sm:max-w-md",children:[e.jsx($,{children:e.jsxs(q,{children:["Avaliar Visita de ",w.name]})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{children:[e.jsx(u,{children:"Data da Visita"}),e.jsx("input",{type:"date",value:N,onChange:s=>b(s.target.value),className:"w-full mt-2 px-3 py-2 border rounded-md"})]}),e.jsxs("div",{children:[e.jsx(u,{children:"AvaliaÃ§Ã£o"}),e.jsx("div",{className:"mt-2",children:D(i,!0)})]}),e.jsxs("div",{children:[e.jsx(u,{children:"ComentÃ¡rio (opcional)"}),e.jsx(G,{placeholder:"Conte-nos sobre sua experiÃªncia...",value:f,onChange:s=>v(s.target.value),className:"mt-2",rows:4})]}),e.jsx(A,{onClick:L,disabled:d.isPending||i===0,className:"w-full",children:d.isPending?"Enviando...":"Enviar AvaliaÃ§Ã£o"})]})]})]}),e.jsxs(c,{children:[e.jsxs(S,{children:[e.jsx(M,{children:"HistÃ³rico de AvaliaÃ§Ãµes"}),e.jsx(F,{children:"Suas avaliaÃ§Ãµes anteriores"})]}),e.jsx(m,{children:C.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(J,{className:"h-12 w-12 mx-auto mb-3 text-muted-foreground opacity-50"}),e.jsx("p",{className:"text-muted-foreground",children:"Nenhuma avaliaÃ§Ã£o ainda"})]}):e.jsx("div",{className:"space-y-4",children:C.map(s=>e.jsxs("div",{className:"p-4 rounded-lg border",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[D(s.rating),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1 flex items-center gap-2",children:[e.jsx(z,{className:"h-4 w-4"}),h(new Date(s.visitDate),"dd 'de' MMMM 'de' yyyy",{locale:K})]})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:h(new Date(s.createdAt),"dd/MM/yyyy")})]}),s.comment&&e.jsx("p",{className:"text-sm mb-3",children:s.comment}),s.response&&e.jsxs("div",{className:"mt-3 p-3 rounded-lg bg-muted",children:[e.jsx("p",{className:"text-xs font-semibold text-muted-foreground mb-1",children:"Resposta da Creche:"}),e.jsx("p",{className:"text-sm",children:s.response}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:h(new Date(s.respondedAt),"dd/MM/yyyy")})]})]},s.id))})})]})]})]})})}export{ie as default};
