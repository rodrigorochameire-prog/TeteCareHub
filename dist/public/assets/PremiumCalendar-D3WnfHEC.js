import{r as m,j as e,B as C,I as j,S as ee,i as te,n as R,K as ae,J as f,o as re,A as se,p as le,q as ne,s as oe,v as ce,C as ie,h}from"./index-DG0yx2hi.js";import{L as de,P as he,S as ue,B as me}from"./popover-Bqiz4euq.js";import{S as M,a as L,b as P,c as E,d as v}from"./select-k5kl2mY3.js";import{T as xe}from"./textarea-BfRN5q_Y.js";import{C as ge}from"./chevron-left-DzbQ4jE-.js";import{C as pe}from"./chevron-right-DecBlSPI.js";import{S as De}from"./search-DtaYG9vz.js";import{F as je}from"./filter-C966fxzX.js";import{L as ve}from"./log-in-USQiO92O.js";import{P as be}from"./plus-DIKUpKHa.js";import{C as ye}from"./clock-BQzFMz2h.js";const F={vaccination:{label:"VacinaÃ§Ã£o",color:"bg-blue-200",lightColor:"bg-blue-50",textColor:"text-gray-900",borderColor:"border-blue-100",icon:ue},medication:{label:"Medicamento",color:"bg-purple-200",lightColor:"bg-purple-50",textColor:"text-gray-900",borderColor:"border-purple-100",icon:he},medical:{label:"Consulta MÃ©dica",color:"bg-rose-200",lightColor:"bg-rose-50",textColor:"text-gray-900",borderColor:"border-rose-100",icon:ae},general:{label:"Geral",color:"bg-slate-200",lightColor:"bg-slate-50",textColor:"text-gray-900",borderColor:"border-slate-100",icon:R},holiday:{label:"Feriado",color:"bg-emerald-200",lightColor:"bg-emerald-50",textColor:"text-gray-900",borderColor:"border-emerald-100",icon:R},closure:{label:"Fechamento",color:"bg-orange-200",lightColor:"bg-orange-50",textColor:"text-gray-900",borderColor:"border-orange-100",icon:te},checkin:{label:"Check-in",color:"bg-teal-200",lightColor:"bg-teal-50",textColor:"text-gray-900",borderColor:"border-teal-100",icon:ve},checkout:{label:"Check-out",color:"bg-amber-200",lightColor:"bg-amber-50",textColor:"text-gray-900",borderColor:"border-amber-100",icon:de},preventive:{label:"Preventivo",color:"bg-cyan-200",lightColor:"bg-cyan-50",textColor:"text-gray-900",borderColor:"border-cyan-100",icon:ee}};function Ye({events:N,onEventClick:k,onDateClick:a,onDayClick:o,onCreateEvent:D,onEventDrop:w,pets:r=[],showCreateButton:x=!0,role:I="admin"}){const[g,Y]=m.useState(new Date),[Ce,Ne]=m.useState("month"),[S,q]=m.useState("all"),[T,Q]=m.useState("all"),[O,z]=m.useState(""),[G,A]=m.useState(!1),B=m.useMemo(()=>N.filter(t=>{if(S!=="all"&&t.eventType!==S||T!=="all"&&t.petId!==T)return!1;if(O){const l=O.toLowerCase();return t.title.toLowerCase().includes(l)||t.description?.toLowerCase().includes(l)||t.petName?.toLowerCase().includes(l)}return!0}),[N,S,T,O]),J=t=>{const l=t.getFullYear(),n=t.getMonth(),p=new Date(l,n,1),s=new Date(l,n+1,0).getDate(),c=p.getDay(),u=[];for(let i=0;i<c;i++)u.push(null);for(let i=1;i<=s;i++)u.push(new Date(l,n,i));return u},K=t=>t?B.filter(l=>{const n=new Date(l.eventDate),p=n.getDate()===t.getDate()&&n.getMonth()===t.getMonth()&&n.getFullYear()===t.getFullYear(),b=l.checkInDate&&l.checkOutDate&&(()=>{const s=new Date(l.checkInDate);s.setHours(0,0,0,0);const c=new Date(l.checkOutDate);c.setHours(0,0,0,0);const u=new Date(t);return u.setHours(0,0,0,0),u>=s&&u<=c})();return p||b}):[],W=()=>{Y(new Date(g.getFullYear(),g.getMonth()-1,1))},_=()=>{Y(new Date(g.getFullYear(),g.getMonth()+1,1))},U=()=>{Y(new Date)},X=g.toLocaleDateString("pt-BR",{month:"long",year:"numeric"}),Z=J(g),$=["Dom","Seg","Ter","Qua","Qui","Sex","SÃ¡b"],y=new Date;return y.setHours(0,0,0,0),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(C,{variant:"outline",size:"icon",onClick:W,className:"h-10 w-10 rounded-xl hover:bg-primary/10 transition-all",children:e.jsx(ge,{className:"h-5 w-5"})}),e.jsx(C,{variant:"outline",onClick:U,className:"min-w-[120px] rounded-xl font-semibold hover:bg-primary/10 transition-all",children:"Hoje"}),e.jsx(C,{variant:"outline",size:"icon",onClick:_,className:"h-10 w-10 rounded-xl hover:bg-primary/10 transition-all",children:e.jsx(pe,{className:"h-5 w-5"})}),e.jsx("h2",{className:"text-2xl font-bold capitalize ml-2",children:X})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(De,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(j,{placeholder:"Buscar eventos...",value:O,onChange:t=>z(t.target.value),className:"pl-10 w-[200px] rounded-xl"})]}),e.jsxs(M,{value:S,onValueChange:t=>q(t),children:[e.jsxs(L,{className:"w-[180px] rounded-xl",children:[e.jsx(je,{className:"h-4 w-4 mr-2"}),e.jsx(P,{placeholder:"Tipo de evento"})]}),e.jsxs(E,{children:[e.jsx(v,{value:"all",children:"Todos os tipos"}),Object.entries(F).map(([t,l])=>e.jsx(v,{value:t,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:f("w-3 h-3 rounded-full",l.color)}),l.label]})},t))]})]}),r.length>0&&e.jsxs(M,{value:T.toString(),onValueChange:t=>Q(t==="all"?"all":parseInt(t)),children:[e.jsx(L,{className:"w-[180px] rounded-xl",children:e.jsx(P,{placeholder:"Filtrar por pet"})}),e.jsxs(E,{children:[e.jsx(v,{value:"all",children:"Todos os pets"}),r.map(t=>e.jsx(v,{value:t.id.toString(),children:t.name},t.id))]})]}),x&&D&&e.jsxs(re,{open:G,onOpenChange:A,children:[e.jsx(se,{asChild:!0,children:e.jsxs(C,{className:"rounded-xl shadow-lg hover:shadow-xl transition-all",children:[e.jsx(be,{className:"h-4 w-4 mr-2"}),"Novo Evento"]})}),e.jsxs(le,{className:"max-w-2xl",children:[e.jsxs(ne,{children:[e.jsx(oe,{children:"Criar Novo Evento"}),e.jsx(ce,{children:"Adicione um novo evento ao calendÃ¡rio"})]}),e.jsx(fe,{onSubmit:t=>{D(t),A(!1)},pets:r})]})]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(F).map(([t,l])=>{const n=l.icon,p=B.filter(b=>b.eventType===t).length;return e.jsxs("div",{className:f("flex items-center gap-1.5 px-2.5 py-1 rounded-full border transition-all text-xs",l.lightColor,l.borderColor,"hover:shadow-sm"),children:[e.jsx(n,{className:"h-3 w-3 text-gray-600"}),e.jsx("span",{className:"font-medium text-gray-900",children:l.label}),e.jsx("span",{className:"text-gray-600 ml-0.5",children:p})]},t)})}),e.jsx(ie,{className:"p-6 shadow-xl border-2",children:e.jsxs("div",{className:"grid grid-cols-7 gap-2",children:[$.map(t=>e.jsx("div",{className:"text-center font-bold text-sm text-muted-foreground py-3",children:t},t)),Z.map((t,l)=>{const n=K(t),p=t&&t.getDate()===y.getDate()&&t.getMonth()===y.getMonth()&&t.getFullYear()===y.getFullYear(),b=t&&t<y;return e.jsx("div",{className:f("min-h-[120px] p-2 rounded-xl border-2 transition-all cursor-pointer",t?"bg-card hover:bg-accent/5 hover:border-primary/30 hover:shadow-md":"bg-muted/20",p&&"ring-2 ring-primary ring-offset-2 bg-primary/5",b&&"opacity-60"),onClick:()=>{t&&(a?.(t),o?.(t))},onDragOver:s=>{t&&(s.preventDefault(),s.currentTarget.classList.add("ring-2","ring-primary","bg-primary/10"))},onDragLeave:s=>{s.currentTarget.classList.remove("ring-2","ring-primary","bg-primary/10")},onDrop:s=>{if(s.preventDefault(),s.currentTarget.classList.remove("ring-2","ring-primary","bg-primary/10"),t){const c=s.dataTransfer.getData("eventId");c&&w&&w(parseInt(c),t)}},children:t&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:f("text-sm font-semibold",p&&"text-primary"),children:t.getDate()}),e.jsx("div",{className:"flex items-center gap-1",children:n.length>0&&e.jsx(me,{variant:"secondary",className:"h-5 w-5 p-0 flex items-center justify-center text-xs",children:n.length})})]}),e.jsxs("div",{className:"space-y-1",children:[n.slice(0,3).map(s=>{const c=F[s.eventType],u=c.icon,i=s.checkInDate&&s.checkOutDate,H=i&&(()=>{const d=new Date(s.checkInDate);return d.getDate()===t.getDate()&&d.getMonth()===t.getMonth()&&d.getFullYear()===t.getFullYear()})(),V=i&&(()=>{const d=new Date(s.checkOutDate);return d.getDate()===t.getDate()&&d.getMonth()===t.getMonth()&&d.getFullYear()===t.getFullYear()})();return e.jsxs("div",{draggable:!0,onDragStart:d=>{d.dataTransfer.setData("eventId",s.id.toString()),d.dataTransfer.effectAllowed="move"},onClick:d=>{d.stopPropagation(),k?.(s)},className:f("px-2 py-1 rounded-lg text-xs font-medium cursor-move transition-all hover:scale-105 hover:shadow-md border",c.lightColor,c.textColor,c.borderColor,i&&"border-2 border-dashed"),children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(u,{className:"h-3 w-3 flex-shrink-0"}),e.jsxs("span",{className:"truncate",children:[H&&"ðŸ‘‰ ",s.title,V&&" ðŸ",i&&!H&&!V&&" ðŸŸ¦"]})]}),i&&s.dailyCount&&e.jsxs("div",{className:"text-[10px] opacity-70 mt-0.5",children:[s.dailyCount," ",s.dailyCount===1?"diÃ¡ria":"diÃ¡rias"]}),!s.isAllDay&&e.jsxs("div",{className:"flex items-center gap-1 mt-0.5 opacity-70",children:[e.jsx(ye,{className:"h-2.5 w-2.5"}),e.jsx("span",{className:"text-[10px]",children:new Date(s.eventDate).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})})]})]},s.id)}),n.length>3&&e.jsxs("div",{className:"text-xs text-muted-foreground text-center py-1",children:["+",n.length-3," mais"]})]})]})},l)})]})})]})}function fe({onSubmit:N,pets:k}){const[a,o]=m.useState({title:"",description:"",eventDate:new Date().toISOString().slice(0,16),endDate:"",eventType:"general",petId:null,location:"",isAllDay:!0,checkInDate:"",checkOutDate:""}),D=m.useMemo(()=>{if(!a.checkInDate||!a.checkOutDate)return null;const r=new Date(a.checkInDate),I=new Date(a.checkOutDate).getTime()-r.getTime(),g=Math.floor(I/(1e3*60*60*24))+1;return Math.max(1,g)},[a.checkInDate,a.checkOutDate]),w=r=>{if(r.preventDefault(),a.endDate){const x=new Date(a.eventDate);if(new Date(a.endDate)<x){alert("Data de tÃ©rmino deve ser posterior Ã  data de inÃ­cio");return}}if(a.checkInDate&&a.checkOutDate){const x=new Date(a.checkInDate);if(new Date(a.checkOutDate)<x){alert("Data de check-out deve ser posterior Ã  data de check-in");return}}N({...a,eventDate:new Date(a.eventDate),endDate:a.endDate?new Date(a.endDate):void 0,checkInDate:a.checkInDate?new Date(a.checkInDate):void 0,checkOutDate:a.checkOutDate?new Date(a.checkOutDate):void 0})};return e.jsxs("form",{onSubmit:w,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"title",children:"TÃ­tulo *"}),e.jsx(j,{id:"title",value:a.title,onChange:r=>o({...a,title:r.target.value}),required:!0,className:"rounded-xl"})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"description",children:"DescriÃ§Ã£o"}),e.jsx(xe,{id:"description",value:a.description,onChange:r=>o({...a,description:r.target.value}),className:"rounded-xl",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"eventType",children:"Tipo de Evento *"}),e.jsxs(M,{value:a.eventType,onValueChange:r=>o({...a,eventType:r}),children:[e.jsx(L,{className:"rounded-xl",children:e.jsx(P,{})}),e.jsx(E,{children:Object.entries(F).map(([r,x])=>e.jsx(v,{value:r,children:x.label},r))})]})]}),k.length>0&&e.jsxs("div",{children:[e.jsx(h,{htmlFor:"petId",children:"Pet (opcional)"}),e.jsxs(M,{value:a.petId?.toString()||"none",onValueChange:r=>o({...a,petId:r==="none"?null:parseInt(r)}),children:[e.jsx(L,{className:"rounded-xl",children:e.jsx(P,{placeholder:"Selecione um pet"})}),e.jsxs(E,{children:[e.jsx(v,{value:"none",children:"Nenhum pet"}),k.map(r=>e.jsx(v,{value:r.id.toString(),children:r.name},r.id))]})]})]})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"eventDate",children:"Data e Hora de InÃ­cio *"}),e.jsx(j,{id:"eventDate",type:"datetime-local",value:a.eventDate,onChange:r=>o({...a,eventDate:r.target.value}),required:!0,className:"rounded-xl"})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"endDate",children:"Data e Hora de TÃ©rmino (Opcional)"}),e.jsx(j,{id:"endDate",type:"datetime-local",value:a.endDate,onChange:r=>o({...a,endDate:r.target.value}),min:a.eventDate,className:"rounded-xl"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1.5",children:"Para eventos que duram vÃ¡rios dias (ex: viagem, hospedagem, tratamento)"})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"location",children:"Local"}),e.jsx(j,{id:"location",value:a.location,onChange:r=>o({...a,location:r.target.value}),className:"rounded-xl",placeholder:"Ex: ClÃ­nica VeterinÃ¡ria"})]}),(a.eventType==="checkin"||a.eventType==="checkout")&&e.jsxs("div",{className:"border-t pt-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx(h,{className:"text-base font-semibold",children:"PerÃ­odo de DiÃ¡rias"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Configure o perÃ­odo de hospedagem (check-in a check-out)"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"checkInDate",children:"Data de Check-in"}),e.jsx(j,{id:"checkInDate",type:"date",value:a.checkInDate,onChange:r=>o({...a,checkInDate:r.target.value}),className:"rounded-xl"})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"checkOutDate",children:"Data de Check-out"}),e.jsx(j,{id:"checkOutDate",type:"date",value:a.checkOutDate,onChange:r=>o({...a,checkOutDate:r.target.value}),className:"rounded-xl",min:a.checkInDate})]})]}),D!==null&&D>0&&e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-800 rounded-xl p-3",children:[e.jsxs("p",{className:"text-sm font-medium text-blue-900 dark:text-blue-100",children:["ðŸ“… Total: ",e.jsxs("span",{className:"font-bold",children:[D," ",D===1?"diÃ¡ria":"diÃ¡rias"]})]}),e.jsxs("p",{className:"text-xs text-blue-700 dark:text-blue-300 mt-1",children:[new Date(a.checkInDate).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"})," a ",new Date(a.checkOutDate).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"isAllDay",checked:a.isAllDay,onChange:r=>o({...a,isAllDay:r.target.checked}),className:"rounded"}),e.jsx(h,{htmlFor:"isAllDay",className:"cursor-pointer",children:"Evento de dia inteiro"})]}),e.jsx("div",{className:"flex justify-end gap-3 pt-4",children:e.jsx(C,{type:"submit",className:"rounded-xl",children:"Criar Evento"})})]})}export{Ye as P};
