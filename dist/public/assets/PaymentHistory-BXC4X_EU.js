import{m as j,r as N,t as y,j as e,C as c,b as i,d as o,f as x,e as A,B as u}from"./index-DG0yx2hi.js";import{B as m}from"./popover-Bqiz4euq.js";import{S as M,a as R,b as B,c as F,d as h}from"./select-k5kl2mY3.js";import{T as H,a as I,b as v,c as r,d as D,e as n}from"./table-DeOYaLOA.js";import{C as L}from"./credit-card-CxD7Buqp.js";import{T as b}from"./trending-up-C2VanZIM.js";import{C as w}from"./circle-x-Ewhe70CR.js";import{C}from"./clock-BQzFMz2h.js";import{f as z,p as V}from"./pt-BR-BIS3WgEC.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=j("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=j("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=j("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);function Y(){const[p,P]=N.useState("all"),[l,f]=N.useState(0),d=20,{data:a,isLoading:S}=y.payments.listAll.useQuery({limit:d,offset:l*d,status:p}),{data:t}=y.payments.getStats.useQuery(),T=s=>{switch(s){case"succeeded":return e.jsxs(m,{variant:"default",className:"gap-1 bg-green-500 hover:bg-green-600",children:[e.jsx(b,{className:"h-3 w-3"}),"Sucesso"]});case"failed":return e.jsxs(m,{variant:"destructive",className:"gap-1",children:[e.jsx(w,{className:"h-3 w-3"}),"Falhou"]});case"pending":return e.jsxs(m,{variant:"secondary",className:"gap-1",children:[e.jsx(C,{className:"h-3 w-3"}),"Pendente"]});default:return e.jsx(m,{variant:"outline",children:s})}},g=s=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(s/100),k=s=>{switch(s){case"plan":return"Plano de Assinatura";case"credits":return"Pacote de Créditos";default:return s}};return e.jsxs("div",{className:"space-y-6",children:[t&&e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs(c,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(o,{className:"text-sm font-medium",children:"Receita Total"}),e.jsx(L,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(x,{children:[e.jsx("div",{className:"text-2xl font-bold",children:g(t.totalRevenue)}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[t.totalCount," transações"]})]})]}),e.jsxs(c,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(o,{className:"text-sm font-medium",children:"Pagamentos Bem-sucedidos"}),e.jsx(b,{className:"h-4 w-4 text-green-500"})]}),e.jsxs(x,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.successCount}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[(t.successCount/t.totalCount*100).toFixed(1),"% de sucesso"]})]})]}),e.jsxs(c,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(o,{className:"text-sm font-medium",children:"Pagamentos Falhados"}),e.jsx(w,{className:"h-4 w-4 text-destructive"})]}),e.jsxs(x,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.failedCount}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[(t.failedCount/t.totalCount*100).toFixed(1),"% de falha"]})]})]}),e.jsxs(c,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(o,{className:"text-sm font-medium",children:"Pagamentos Pendentes"}),e.jsx(C,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(x,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.pendingCount}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Aguardando confirmação"})]})]})]}),e.jsxs(c,{children:[e.jsx(i,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(o,{children:"Histórico de Pagamentos"}),e.jsx(A,{children:"Todas as transações processadas via Stripe"})]}),e.jsxs(M,{value:p,onValueChange:s=>P(s),children:[e.jsx(R,{className:"w-[180px]",children:e.jsx(B,{placeholder:"Filtrar por status"})}),e.jsxs(F,{children:[e.jsx(h,{value:"all",children:"Todos"}),e.jsx(h,{value:"succeeded",children:"Sucesso"}),e.jsx(h,{value:"failed",children:"Falhou"}),e.jsx(h,{value:"pending",children:"Pendente"})]})]})]})}),e.jsx(x,{children:S?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Carregando..."}):a&&a.payments&&a.payments.length>0?e.jsxs(e.Fragment,{children:[e.jsxs(H,{children:[e.jsx(I,{children:e.jsxs(v,{children:[e.jsx(r,{children:"ID"}),e.jsx(r,{children:"Data"}),e.jsx(r,{children:"Tipo"}),e.jsx(r,{children:"Produto"}),e.jsx(r,{children:"Valor"}),e.jsx(r,{children:"Status"}),e.jsx(r,{className:"text-right",children:"Ações"})]})}),e.jsx(D,{children:a?.payments?.map(s=>e.jsxs(v,{children:[e.jsxs(n,{className:"font-mono text-xs",children:[s.stripePaymentIntentId.substring(0,20),"..."]}),e.jsx(n,{children:z(new Date(s.createdAt),"dd/MM/yyyy HH:mm",{locale:V})}),e.jsx(n,{children:k(s.productType)}),e.jsx(n,{className:"font-medium",children:s.productKey||"-"}),e.jsx(n,{className:"font-bold",children:g(s.amount)}),e.jsx(n,{children:T(s.status)}),e.jsx(n,{className:"text-right",children:e.jsxs(u,{variant:"ghost",size:"sm",className:"gap-2",onClick:()=>{window.open(`https://dashboard.stripe.com/payments/${s.stripePaymentIntentId}`,"_blank")},children:[e.jsx(E,{className:"h-4 w-4"}),"Ver no Stripe"]})})]},s.id))})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Mostrando ",l*d+1," a ",Math.min((l+1)*d,a?.total||0)," de ",a?.total||0," pagamentos"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{variant:"outline",size:"sm",onClick:()=>f(s=>Math.max(0,s-1)),disabled:l===0,children:"Anterior"}),e.jsx(u,{variant:"outline",size:"sm",onClick:()=>f(s=>s+1),disabled:(l+1)*d>=(a?.total||0),children:"Próxima"})]})]})]}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Nenhum pagamento encontrado"})})]})]})}export{W as A,Y as P,O as a};
