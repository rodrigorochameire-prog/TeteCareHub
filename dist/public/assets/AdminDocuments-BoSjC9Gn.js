import{m as D,r as t,t as u,a as l,j as e,o as k,A as ae,B as m,p as z,q as L,s as q,h as c,I as R,C as p}from"./index-DG0yx2hi.js";import{A as te}from"./AdminLayout-CapzJ-JK.js";import{B as re,F as le}from"./popover-Bqiz4euq.js";import{S as j,a as g,b as f,c as v,d}from"./select-k5kl2mY3.js";import{T as ie,a as ne,b as N,c as i,d as oe,e as r}from"./table-DeOYaLOA.js";import{U as ce}from"./upload-Ck_fQFtx.js";import{D as de}from"./download-DIpAs7NP.js";import{I as xe}from"./image-BoirZu0B.js";import"./scroll-area-C0S6gB82.js";import"./index-BdQq_4o_.js";import"./layout-dashboard-CC4g-mOh.js";import"./wallet-CKmMh37E.js";import"./users-DD1qYPM2.js";import"./user-B4BzRHVK.js";import"./index-r4-iOF84.js";import"./chevron-down-CKVtRMqG.js";import"./check-DDByOptX.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=D("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=D("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=D("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]),h={vaccination_card:"Carteira de Vacinação",veterinary_document:"Documento Veterinário",exam:"Exame",certificate:"Certificado",prescription:"Prescrição",other:"Outro"},ue={vaccination_card:"bg-green-500/20 text-green-700 border-green-300",veterinary_document:"bg-blue-500/20 text-blue-700 border-blue-300",exam:"bg-purple-500/20 text-purple-700 border-purple-300",certificate:"bg-yellow-500/20 text-yellow-700 border-yellow-300",prescription:"bg-orange-500/20 text-orange-700 border-orange-300",other:"bg-gray-500/20 text-gray-700 border-gray-300"};function Fe(){const[P,G]=t.useState(),[A,_]=t.useState(),[H,O]=t.useState(!1),[$,E]=t.useState(!1),[n,J]=t.useState(null),[y,Q]=t.useState(),[b,F]=t.useState(""),[C,V]=t.useState(""),[o,M]=t.useState(null),{data:x,isLoading:W,refetch:I}=u.documents.listAll.useQuery({petId:P,category:A}),{data:B}=u.pets.list.useQuery(),w=u.documents.upload.useMutation({onSuccess:()=>{l.success("Documento enviado com sucesso!"),O(!1),F(""),V(""),M(null),I()},onError:s=>{l.error(`Erro ao enviar documento: ${s.message}`)}}),Y=u.documents.delete.useMutation({onSuccess:()=>{l.success("Documento excluído com sucesso!"),I()},onError:s=>{l.error(`Erro ao excluir documento: ${s.message}`)}}),K=async()=>{if(!y||!b||!C||!o){l.error("Preencha todos os campos");return}if(o.size>10*1024*1024){l.error("Arquivo muito grande. O tamanho máximo é 10MB");return}if(!["application/pdf","image/jpeg","image/jpg","image/png"].includes(o.type)){l.error("Tipo de arquivo não permitido. Apenas PDF, JPG e PNG são permitidos");return}const a=new FileReader;a.onload=async S=>{const se=S.target?.result;await w.mutateAsync({petId:y,title:b,category:C,fileData:se,fileName:o.name,mimeType:o.type})},a.readAsDataURL(o)},Z=s=>{confirm("Tem certeza que deseja excluir este documento?")&&Y.mutate({id:s})},X=s=>s?s<1024?`${s} B`:s<1024*1024?`${(s/1024).toFixed(1)} KB`:`${(s/(1024*1024)).toFixed(1)} MB`:"N/A",ee=s=>s?s.startsWith("image/")?e.jsx(xe,{className:"h-4 w-4"}):s==="application/pdf"?e.jsx(le,{className:"h-4 w-4"}):e.jsx(T,{className:"h-4 w-4"}):e.jsx(T,{className:"h-4 w-4"}),U={total:x?.length||0,byCategory:Object.keys(h).reduce((s,a)=>(s[a]=x?.filter(S=>S.category===a).length||0,s),{})};return e.jsx(te,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Documentos"}),e.jsx("p",{className:"text-muted-foreground",children:"Gerenciar documentos veterinários, exames e certificados"})]}),e.jsxs(k,{open:H,onOpenChange:O,children:[e.jsx(ae,{asChild:!0,children:e.jsxs(m,{children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"Enviar Documento"]})}),e.jsxs(z,{children:[e.jsx(L,{children:e.jsx(q,{children:"Enviar Documento"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(c,{children:"Pet"}),e.jsxs(j,{value:y?.toString(),onValueChange:s=>Q(Number(s)),children:[e.jsx(g,{children:e.jsx(f,{placeholder:"Selecione o pet"})}),e.jsx(v,{children:B?.map(s=>e.jsx(d,{value:s.id.toString(),children:s.name},s.id))})]})]}),e.jsxs("div",{children:[e.jsx(c,{children:"Título"}),e.jsx(R,{value:b,onChange:s=>F(s.target.value),placeholder:"Ex: Carteira de Vacinação 2025"})]}),e.jsxs("div",{children:[e.jsx(c,{children:"Categoria"}),e.jsxs(j,{value:C,onValueChange:V,children:[e.jsx(g,{children:e.jsx(f,{placeholder:"Selecione a categoria"})}),e.jsx(v,{children:Object.entries(h).map(([s,a])=>e.jsx(d,{value:s,children:a},s))})]})]}),e.jsxs("div",{children:[e.jsx(c,{children:"Arquivo (PDF, JPG, PNG - Máx 10MB)"}),e.jsx(R,{type:"file",accept:".pdf,.jpg,.jpeg,.png",onChange:s=>M(s.target.files?.[0]||null)})]}),e.jsx(m,{onClick:K,disabled:w.isPending,className:"w-full",children:w.isPending?"Enviando...":"Enviar"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(p,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total de Documentos"}),e.jsx("p",{className:"text-2xl font-bold",children:U.total})]}),e.jsx(me,{className:"h-8 w-8 text-muted-foreground"})]})}),Object.entries(h).slice(0,3).map(([s,a])=>e.jsx(p,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:a}),e.jsx("p",{className:"text-2xl font-bold",children:U.byCategory[s]})]}),e.jsx(T,{className:"h-8 w-8 text-muted-foreground"})]})},s))]}),e.jsx(p,{className:"p-4",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(c,{children:"Filtrar por Pet"}),e.jsxs(j,{value:P?.toString()||"all",onValueChange:s=>G(s==="all"?void 0:Number(s)),children:[e.jsx(g,{children:e.jsx(f,{placeholder:"Todos os pets"})}),e.jsxs(v,{children:[e.jsx(d,{value:"all",children:"Todos os pets"}),B?.map(s=>e.jsx(d,{value:s.id.toString(),children:s.name},s.id))]})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx(c,{children:"Filtrar por Categoria"}),e.jsxs(j,{value:A||"all",onValueChange:s=>_(s==="all"?void 0:s),children:[e.jsx(g,{children:e.jsx(f,{placeholder:"Todas as categorias"})}),e.jsxs(v,{children:[e.jsx(d,{value:"all",children:"Todas as categorias"}),Object.entries(h).map(([s,a])=>e.jsx(d,{value:s,children:a},s))]})]})]})]})}),e.jsx(p,{children:e.jsxs(ie,{children:[e.jsx(ne,{children:e.jsxs(N,{children:[e.jsx(i,{children:"Tipo"}),e.jsx(i,{children:"Título"}),e.jsx(i,{children:"Pet"}),e.jsx(i,{children:"Categoria"}),e.jsx(i,{children:"Tamanho"}),e.jsx(i,{children:"Data"}),e.jsx(i,{children:"Ações"})]})}),e.jsx(oe,{children:W?e.jsx(N,{children:e.jsx(r,{colSpan:7,className:"text-center",children:"Carregando..."})}):x&&x.length>0?x.map(s=>e.jsxs(N,{children:[e.jsx(r,{children:ee(s.mimeType||void 0)}),e.jsx(r,{className:"font-medium",children:s.title}),e.jsx(r,{children:s.petName}),e.jsx(r,{children:e.jsx(re,{variant:"outline",className:ue[s.category],children:h[s.category]})}),e.jsx(r,{children:X(s.fileSize||void 0)}),e.jsx(r,{children:new Date(s.createdAt).toLocaleDateString("pt-BR")}),e.jsx(r,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(m,{size:"sm",variant:"outline",onClick:()=>{J(s),E(!0)},children:"Ver"}),e.jsx(m,{size:"sm",variant:"outline",onClick:()=>window.open(s.fileUrl,"_blank"),children:e.jsx(de,{className:"h-4 w-4"})}),e.jsx(m,{size:"sm",variant:"outline",onClick:()=>Z(s.id),children:e.jsx(he,{className:"h-4 w-4"})})]})})]},s.id)):e.jsx(N,{children:e.jsx(r,{colSpan:7,className:"text-center text-muted-foreground",children:"Nenhum documento encontrado"})})})]})}),e.jsx(k,{open:$,onOpenChange:E,children:e.jsxs(z,{className:"max-w-4xl max-h-[90vh]",children:[e.jsx(L,{children:e.jsx(q,{children:n?.title})}),e.jsx("div",{className:"overflow-auto",children:n?.mimeType?.startsWith("image/")?e.jsx("img",{src:n.fileUrl,alt:n.title,className:"w-full"}):n?.mimeType==="application/pdf"?e.jsx("iframe",{src:n.fileUrl,className:"w-full h-[70vh]"}):e.jsx("p",{className:"text-center text-muted-foreground",children:"Visualização não disponível para este tipo de arquivo"})})]})})]})})}export{Fe as default};
