import{t as o,r as t,a as n,j as e,B as a,C as h,h as l,o as K,p as W,q as X,s as Y,I as u}from"./index-DG0yx2hi.js";import{A as y}from"./AdminLayout-CapzJ-JK.js";import{T as Z}from"./textarea-BfRN5q_Y.js";import{T as Ne,a as fe,b as _,c as ee}from"./tabs-sUy1g-fW.js";import{S as C,a as S,b as T,c as P,d as r}from"./select-k5kl2mY3.js";import{a as se,B as D}from"./popover-Bqiz4euq.js";import{P as ae}from"./progress-BQ_EYLtW.js";import{g as be,A as te}from"./pdfGenerator-DyKjF6-8.js";import{F as we}from"./file-down-Q5_fAv-7.js";import{P as j}from"./plus-DIKUpKHa.js";import{M as ye}from"./map-pin-Ddjw85I1.js";import{T as re}from"./trash-2-6I2MbiK3.js";import{M as Ce,F as Se}from"./meh-DzyMYYW6.js";import{S as Te}from"./smile-Bn_kV9F9.js";import"./scroll-area-C0S6gB82.js";import"./index-BdQq_4o_.js";import"./layout-dashboard-CC4g-mOh.js";import"./wallet-CKmMh37E.js";import"./users-DD1qYPM2.js";import"./user-B4BzRHVK.js";import"./index-r4-iOF84.js";import"./chevron-down-CKVtRMqG.js";import"./check-DDByOptX.js";import"./jspdf.es.min-CAUmCEfZ.js";import"./pt-BR-BIS3WgEC.js";function Ze(){const{data:ie=[],isLoading:ne}=o.pets.list.useQuery(),v=ie,[i,le]=t.useState(null),[oe,c]=t.useState(!1),[ce,d]=t.useState(!1),[L,k]=t.useState(new Date().toISOString().split("T")[0]),[B,R]=t.useState("home"),[I,F]=t.useState("neutral"),[g,A]=t.useState(""),[M,E]=t.useState(""),[O,V]=t.useState("leve"),[p,z]=t.useState(""),[N,H]=t.useState(1),[Q,$]=t.useState(""),m=v.find(s=>s.id===i),{data:x=[],refetch:U}=o.behavior.list.useQuery({petId:i??void 0},{enabled:!!i}),{data:q=[],refetch:f}=o.training.list.useQuery({petId:i??void 0},{enabled:!!i}),b=o.behavior.create.useMutation({onSuccess:()=>{n.success("Comportamento registrado com sucesso!"),U(),c(!1),he()},onError:s=>{n.error(`Erro ao registrar comportamento: ${s.message}`)}}),de=o.behavior.delete.useMutation({onSuccess:()=>{n.success("Registro deletado!"),U()}}),w=o.training.create.useMutation({onSuccess:()=>{n.success("Adestramento registrado com sucesso!"),f(),d(!1),xe()},onError:s=>{n.error(`Erro ao registrar adestramento: ${s.message}`)}}),G=o.training.update.useMutation({onSuccess:()=>{n.success("Progresso atualizado!"),f()}}),me=o.training.delete.useMutation({onSuccess:()=>{n.success("Registro deletado!"),f()}}),he=()=>{k(new Date().toISOString().split("T")[0]),R("home"),F("neutral"),A(""),E(""),V("leve")},xe=()=>{z(""),H(1),$("")},ue=()=>{if(!i||!g){n.error("Preencha todos os campos obrigatórios");return}b.mutate({petId:i,date:new Date(L),location:B,behaviorType:I,description:g,tags:M||void 0,severity:O||void 0})},je=()=>{if(!i||!p){n.error("Preencha todos os campos obrigatórios");return}w.mutate({petId:i,skill:p,startDate:new Date,currentLevel:N,notes:Q||void 0})},ve=s=>{switch(s){case"positive":return e.jsx(Te,{className:"h-5 w-5 text-green-500"});case"negative":return e.jsx(Se,{className:"h-5 w-5 text-red-500"});default:return e.jsx(Ce,{className:"h-5 w-5 text-gray-500"})}},ge=s=>({daycare:"Creche",home:"Casa",walk:"Passeio",vet:"Veterinário",other:"Outro"})[s]||s;return ne?e.jsx(y,{children:e.jsx("div",{className:"container max-w-7xl py-8 animate-fade-in",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-muted-foreground",children:"Carregando..."})})})}):v.length===0?e.jsx(y,{children:e.jsx("div",{className:"container max-w-7xl py-8 animate-fade-in",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(se,{className:"h-16 w-16 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Nenhum pet cadastrado"}),e.jsx("p",{className:"text-muted-foreground",children:"Cadastre um pet para começar a registrar comportamentos."})]})})}):e.jsx(y,{children:e.jsxs("div",{className:"container max-w-7xl py-8 animate-fade-in",children:[e.jsxs("div",{className:"mb-8 flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Comportamento & Adestramento"}),e.jsx("p",{className:"text-muted-foreground",children:"Registre e acompanhe o comportamento do seu pet em diferentes ambientes"})]}),m&&x.length>0&&e.jsxs(a,{onClick:()=>{be({petName:m.name,period:"Últimos 30 dias",records:x.map(s=>({date:s.date,location:s.location,behaviorType:s.behaviorType,description:s.description,severity:s.severity}))}),n.success("Relatório PDF gerado com sucesso!")},className:"flex items-center gap-2",children:[e.jsx(we,{className:"h-4 w-4"}),"Exportar PDF"]})]}),e.jsxs(h,{className:"p-6 mb-6",children:[e.jsx(l,{className:"mb-2 block",children:"Selecione o Pet"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:v.map(s=>e.jsx("button",{onClick:()=>le(s.id),className:`p-4 rounded-lg border-2 transition-all hover:shadow-md ${i===s.id?"border-primary bg-primary/5":"border-border hover:border-primary/50"}`,children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[s.photoUrl?e.jsx("img",{src:s.photoUrl,alt:s.name,className:"w-16 h-16 rounded-full object-cover"}):e.jsx("div",{className:"w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx("span",{className:"text-2xl font-bold text-primary",children:s.name[0]})}),e.jsx("span",{className:"font-medium",children:s.name})]})},s.id))})]}),m&&e.jsxs(Ne,{defaultValue:"behavior",className:"space-y-6",children:[e.jsxs(fe,{className:"grid w-full grid-cols-2",children:[e.jsx(_,{value:"behavior",children:"Registros de Comportamento"}),e.jsx(_,{value:"training",children:"Adestramento"})]}),e.jsxs(ee,{value:"behavior",className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Histórico de Comportamento"}),e.jsxs(a,{onClick:()=>c(!0),children:[e.jsx(j,{className:"h-4 w-4 mr-2"}),"Novo Registro"]})]}),x.length===0?e.jsxs(h,{className:"p-12 text-center",children:[e.jsx(se,{className:"h-16 w-16 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Nenhum registro ainda"}),e.jsxs("p",{className:"text-muted-foreground mb-4",children:["Comece a registrar o comportamento de ",m.name]}),e.jsxs(a,{onClick:()=>c(!0),children:[e.jsx(j,{className:"h-4 w-4 mr-2"}),"Primeiro Registro"]})]}):e.jsx("div",{className:"space-y-4",children:x.map(s=>e.jsx(h,{className:"p-6 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[e.jsx("div",{className:"mt-1",children:ve(s.behaviorType)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"font-semibold",children:new Date(s.date).toLocaleDateString("pt-BR")}),e.jsxs(D,{variant:"outline",className:"gap-1",children:[e.jsx(ye,{className:"h-3 w-3"}),ge(s.location)]}),s.severity&&e.jsx(D,{variant:s.severity==="grave"?"destructive":s.severity==="moderado"?"default":"secondary",children:s.severity})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:s.description}),s.tags&&e.jsx("div",{className:"flex flex-wrap gap-2",children:s.tags.split(",").map((J,pe)=>e.jsx(D,{variant:"secondary",className:"text-xs",children:J.trim()},pe))})]})]}),e.jsx(a,{variant:"ghost",size:"icon",onClick:()=>de.mutate({id:s.id}),children:e.jsx(re,{className:"h-4 w-4 text-destructive"})})]})},s.id))})]}),e.jsxs(ee,{value:"training",className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Progresso de Adestramento"}),e.jsxs(a,{onClick:()=>d(!0),children:[e.jsx(j,{className:"h-4 w-4 mr-2"}),"Nova Habilidade"]})]}),q.length===0?e.jsxs(h,{className:"p-12 text-center",children:[e.jsx(te,{className:"h-16 w-16 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Nenhum adestramento registrado"}),e.jsxs("p",{className:"text-muted-foreground mb-4",children:["Comece a acompanhar o progresso de ",m.name]}),e.jsxs(a,{onClick:()=>d(!0),children:[e.jsx(j,{className:"h-4 w-4 mr-2"}),"Primeira Habilidade"]})]}):e.jsx("div",{className:"grid gap-4",children:q.map(s=>e.jsxs(h,{className:"p-6 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(te,{className:"h-6 w-6 text-primary"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.skill}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Iniciado em ",new Date(s.startDate).toLocaleDateString("pt-BR")]})]})]}),e.jsx(a,{variant:"ghost",size:"icon",onClick:()=>me.mutate({id:s.id}),children:e.jsx(re,{className:"h-4 w-4 text-destructive"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Nível atual"}),e.jsxs("span",{className:"font-semibold",children:[s.currentLevel,"/10"]})]}),e.jsx(ae,{value:s.currentLevel*10,className:"h-2"})]}),s.notes&&e.jsx("p",{className:"text-sm text-muted-foreground mt-4 p-3 bg-muted/50 rounded-lg",children:s.notes}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsx(a,{size:"sm",variant:"outline",disabled:s.currentLevel<=1,onClick:()=>G.mutate({id:s.id,currentLevel:s.currentLevel-1}),children:"-"}),e.jsx(a,{size:"sm",disabled:s.currentLevel>=10,onClick:()=>G.mutate({id:s.id,currentLevel:s.currentLevel+1}),children:"+"})]})]},s.id))})]})]}),e.jsx(K,{open:oe,onOpenChange:c,children:e.jsxs(W,{className:"max-w-lg",children:[e.jsx(X,{children:e.jsx(Y,{children:"Registrar Comportamento"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Data"}),e.jsx(u,{type:"date",value:L,onChange:s=>k(s.target.value)})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Local"}),e.jsxs(C,{value:B,onValueChange:s=>R(s),children:[e.jsx(S,{children:e.jsx(T,{})}),e.jsxs(P,{children:[e.jsx(r,{value:"home",children:"Casa"}),e.jsx(r,{value:"daycare",children:"Creche"}),e.jsx(r,{value:"walk",children:"Passeio"}),e.jsx(r,{value:"vet",children:"Veterinário"}),e.jsx(r,{value:"other",children:"Outro"})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Tipo de Comportamento"}),e.jsxs(C,{value:I,onValueChange:s=>F(s),children:[e.jsx(S,{children:e.jsx(T,{})}),e.jsxs(P,{children:[e.jsx(r,{value:"positive",children:"Positivo"}),e.jsx(r,{value:"neutral",children:"Neutro"}),e.jsx(r,{value:"negative",children:"Negativo"})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Severidade"}),e.jsxs(C,{value:O,onValueChange:V,children:[e.jsx(S,{children:e.jsx(T,{})}),e.jsxs(P,{children:[e.jsx(r,{value:"leve",children:"Leve"}),e.jsx(r,{value:"moderado",children:"Moderado"}),e.jsx(r,{value:"grave",children:"Grave"})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Descrição *"}),e.jsx(Z,{value:g,onChange:s=>A(s.target.value),placeholder:"Descreva o comportamento observado...",rows:4})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Tags (separadas por vírgula)"}),e.jsx(u,{value:M,onChange:s=>E(s.target.value),placeholder:"agressividade, ansiedade, socialização"})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx(a,{onClick:ue,disabled:b.isPending,className:"flex-1",children:b.isPending?"Salvando...":"Salvar"}),e.jsx(a,{variant:"outline",onClick:()=>c(!1),children:"Cancelar"})]})]})]})}),e.jsx(K,{open:ce,onOpenChange:d,children:e.jsxs(W,{className:"max-w-lg",children:[e.jsx(X,{children:e.jsx(Y,{children:"Nova Habilidade de Adestramento"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Habilidade *"}),e.jsx(u,{value:p,onChange:s=>z(s.target.value),placeholder:"Ex: Sentar, Deitar, Buscar..."})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Nível Atual (1-10)"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(u,{type:"number",min:1,max:10,value:N,onChange:s=>H(Number(s.target.value))}),e.jsx(ae,{value:N*10,className:"flex-1"})]})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Observações"}),e.jsx(Z,{value:Q,onChange:s=>$(s.target.value),placeholder:"Notas sobre o progresso...",rows:3})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx(a,{onClick:je,disabled:w.isPending,className:"flex-1",children:w.isPending?"Salvando...":"Salvar"}),e.jsx(a,{variant:"outline",onClick:()=>d(!1),children:"Cancelar"})]})]})]})})]})})}export{Ze as default};
