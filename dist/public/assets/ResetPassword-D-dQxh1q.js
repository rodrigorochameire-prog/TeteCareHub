import{u as k,r as n,t as y,a as t,j as e,C as l,b as d,i as P,d as m,e as u,g as h,B as i,L as x,c as L,f as R,h as j,I as g}from"./index-DG0yx2hi.js";import{K as E}from"./key-round-B6ymMUey.js";function F(){const[,w]=k(),[a,p]=n.useState(""),[r,N]=n.useState(""),[c,v]=n.useState(""),[b,C]=n.useState(!1);n.useEffect(()=>{const f=new URLSearchParams(window.location.search).get("token");f&&v(f)},[]);const o=y.auth.resetPassword.useMutation({onSuccess:()=>{C(!0),t.success("Senha redefinida! Sua senha foi alterada com sucesso. Você já pode fazer login."),setTimeout(()=>{w("/login")},3e3)},onError:s=>{t.error(`Erro ao redefinir senha: ${s.message}`)}}),S=s=>{if(s.preventDefault(),!c){t.error("O link de redefinição de senha está incompleto ou inválido.");return}if(a.length<6){t.error("A senha deve ter no mínimo 6 caracteres.");return}if(a!==r){t.error("As senhas digitadas não são iguais.");return}o.mutate({token:c,newPassword:a})};return c?b?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-background to-accent/5 p-4",children:e.jsxs(l,{className:"w-full max-w-md",children:[e.jsxs(d,{className:"text-center",children:[e.jsx("div",{className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-green-100 dark:bg-green-900",children:e.jsx(L,{className:"h-8 w-8 text-green-600 dark:text-green-400"})}),e.jsx(m,{className:"text-2xl",children:"Senha Redefinida!"}),e.jsx(u,{children:"Sua senha foi alterada com sucesso. Redirecionando para o login..."})]}),e.jsx(h,{children:e.jsx(i,{className:"w-full",asChild:!0,children:e.jsx(x,{href:"/login",children:"Ir para o login"})})})]})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-background to-accent/5 p-4",children:e.jsxs(l,{className:"w-full max-w-md",children:[e.jsxs(d,{className:"text-center",children:[e.jsx("div",{className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-primary/10",children:e.jsx(E,{className:"h-8 w-8 text-primary"})}),e.jsx(m,{className:"text-2xl",children:"Redefinir Senha"}),e.jsx(u,{children:"Digite sua nova senha abaixo."})]}),e.jsxs("form",{onSubmit:S,children:[e.jsxs(R,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"newPassword",children:"Nova Senha"}),e.jsx(g,{id:"newPassword",type:"password",placeholder:"Mínimo 6 caracteres",value:a,onChange:s=>p(s.target.value),required:!0,autoFocus:!0,minLength:6})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"confirmPassword",children:"Confirmar Senha"}),e.jsx(g,{id:"confirmPassword",type:"password",placeholder:"Digite a senha novamente",value:r,onChange:s=>N(s.target.value),required:!0,minLength:6})]}),a&&r&&a!==r&&e.jsx("p",{className:"text-sm text-destructive",children:"As senhas não conferem"})]}),e.jsxs(h,{className:"flex flex-col gap-4",children:[e.jsx(i,{type:"submit",className:"w-full",disabled:o.isPending||a!==r,children:o.isPending?"Redefinindo...":"Redefinir senha"}),e.jsx(i,{variant:"ghost",className:"w-full",asChild:!0,children:e.jsx(x,{href:"/login",children:"Cancelar"})})]})]})]})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-background to-accent/5 p-4",children:e.jsxs(l,{className:"w-full max-w-md",children:[e.jsxs(d,{className:"text-center",children:[e.jsx("div",{className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-destructive/10",children:e.jsx(P,{className:"h-8 w-8 text-destructive"})}),e.jsx(m,{className:"text-2xl",children:"Link Inválido"}),e.jsx(u,{children:"O link de redefinição de senha está incompleto ou inválido."})]}),e.jsx(h,{children:e.jsx(i,{variant:"outline",className:"w-full",asChild:!0,children:e.jsx(x,{href:"/forgot-password",children:"Solicitar novo link"})})})]})})}export{F as default};
