import{r as v,t as l,a as n,j as e,C as g,f,B as d,b as z,d as B,e as O,n as L,o as y,p as b,q as D,s as C,v as P,h as i,I as r,w as A}from"./index-DG0yx2hi.js";import{A as N}from"./AdminLayout-CapzJ-JK.js";import{B as M}from"./popover-Bqiz4euq.js";import{T as w}from"./textarea-BfRN5q_Y.js";import{P as R}from"./plus-DIKUpKHa.js";import{P as $}from"./package-CC5WVNv6.js";import{C as H}from"./credit-card-CxD7Buqp.js";import{S as U}from"./square-pen-D7F5zf6L.js";import{T as G}from"./trash-2-6I2MbiK3.js";import"./scroll-area-C0S6gB82.js";import"./index-BdQq_4o_.js";import"./layout-dashboard-CC4g-mOh.js";import"./wallet-CKmMh37E.js";import"./users-DD1qYPM2.js";import"./user-B4BzRHVK.js";function ne(){const[F,c]=v.useState(!1),[E,o]=v.useState(!1),[t,p]=v.useState(null),{data:h,isLoading:S,error:m}=l.plans.list.useQuery(),u=l.useUtils();m&&console.error("Error loading plans:",m);const j=l.plans.create.useMutation({onSuccess:()=>{n.success("Plano criado com sucesso!"),u.plans.list.invalidate(),c(!1)},onError:s=>{n.error("Erro ao criar plano: "+s.message)}}),x=l.plans.update.useMutation({onSuccess:()=>{n.success("Plano atualizado com sucesso!"),u.plans.list.invalidate(),o(!1),p(null)},onError:s=>{n.error("Erro ao atualizar plano: "+s.message)}}),q=l.plans.delete.useMutation({onSuccess:()=>{n.success("Plano removido com sucesso!"),u.plans.list.invalidate()},onError:s=>{n.error("Erro ao remover plano: "+s.message)}}),I=s=>{s.preventDefault();const a=new FormData(s.currentTarget);j.mutate({name:a.get("name"),description:a.get("description"),price:parseInt(a.get("price"))*100,credits:parseInt(a.get("credits")),validityDays:parseInt(a.get("validityDays")),benefits:a.get("benefits")})},k=s=>{s.preventDefault();const a=new FormData(s.currentTarget);x.mutate({id:t.id,name:a.get("name"),description:a.get("description"),price:parseInt(a.get("price"))*100,credits:parseInt(a.get("credits")),validityDays:parseInt(a.get("validityDays")),benefits:a.get("benefits"),isActive:a.get("isActive")==="on"})},T=s=>{confirm("Tem certeza que deseja remover este plano?")&&q.mutate({id:s})},V=s=>{x.mutate({id:s.id,isActive:!s.isActive})};return m?e.jsx(N,{children:e.jsx("div",{className:"container py-8",children:e.jsx(g,{className:"border-red-200 bg-red-50/50",children:e.jsx(f,{className:"pt-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-red-600 font-medium mb-2",children:"Erro ao carregar planos"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:m.message})]})})})})}):S?e.jsx(N,{children:e.jsx("div",{className:"container py-8",children:e.jsx("p",{children:"Carregando planos..."})})}):e.jsx(N,{children:e.jsxs("div",{className:"container py-8 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Planos de Assinatura"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Gerencie os planos disponíveis para os tutores"})]}),e.jsxs(d,{onClick:()=>c(!0),children:[e.jsx(R,{className:"mr-2 h-4 w-4"}),"Novo Plano"]})]}),!h||h.length===0?e.jsx(g,{children:e.jsxs(f,{className:"empty-state",children:[e.jsx($,{className:"empty-state-icon"}),e.jsx("p",{className:"empty-state-title",children:"Nenhum plano cadastrado"}),e.jsx("p",{className:"empty-state-description",children:"Crie planos de assinatura para oferecer aos tutores"})]})}):e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:h.map(s=>e.jsxs(g,{className:"shadow-card border-border/50",children:[e.jsxs(z,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(B,{className:"text-xl",children:s.name}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(M,{variant:s.isActive?"default":"secondary",children:s.isActive?"Ativo":"Inativo"})})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-3xl font-bold",children:["R$ ",(s.price/100).toFixed(2)]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["/ ",s.validityDays," dias"]})]})]}),s.description&&e.jsx(O,{className:"mt-2",children:s.description})]}),e.jsxs(f,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(H,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.credits}),e.jsx("p",{className:"text-muted-foreground",children:"Diárias"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.validityDays}),e.jsx("p",{className:"text-muted-foreground",children:"Dias"})]})]})]}),s.benefits&&e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Benefícios:"}),e.jsx("p",{className:"text-sm text-muted-foreground whitespace-pre-line",children:s.benefits})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsxs(d,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>{p(s),o(!0)},children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"Editar"]}),e.jsx(d,{variant:s.isActive?"outline":"default",size:"sm",onClick:()=>V(s),children:s.isActive?"Desativar":"Ativar"}),e.jsx(d,{variant:"destructive",size:"sm",onClick:()=>T(s.id),children:e.jsx(G,{className:"h-4 w-4"})})]})]})]},s.id))}),e.jsx(y,{open:F,onOpenChange:c,children:e.jsx(b,{className:"max-w-2xl",children:e.jsxs("form",{onSubmit:I,children:[e.jsxs(D,{children:[e.jsx(C,{children:"Criar Novo Plano"}),e.jsx(P,{children:"Defina os detalhes do plano de assinatura"})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"name",children:"Nome do Plano *"}),e.jsx(r,{id:"name",name:"name",required:!0,placeholder:"Ex: Plano Mensal"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"price",children:"Preço (R$) *"}),e.jsx(r,{id:"price",name:"price",type:"number",step:"0.01",required:!0,placeholder:"99.90"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"credits",children:"Número de Diárias *"}),e.jsx(r,{id:"credits",name:"credits",type:"number",required:!0,placeholder:"10"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"validityDays",children:"Validade (dias) *"}),e.jsx(r,{id:"validityDays",name:"validityDays",type:"number",required:!0,placeholder:"30"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"description",children:"Descrição"}),e.jsx(r,{id:"description",name:"description",placeholder:"Descrição breve do plano"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"benefits",children:"Benefícios"}),e.jsx(w,{id:"benefits",name:"benefits",rows:4,placeholder:"Liste os benefícios do plano (um por linha)"})]})]}),e.jsxs(A,{children:[e.jsx(d,{type:"button",variant:"outline",onClick:()=>c(!1),children:"Cancelar"}),e.jsx(d,{type:"submit",disabled:j.isPending,children:j.isPending?"Criando...":"Criar Plano"})]})]})})}),e.jsx(y,{open:E,onOpenChange:o,children:e.jsx(b,{className:"max-w-2xl",children:e.jsxs("form",{onSubmit:k,children:[e.jsxs(D,{children:[e.jsx(C,{children:"Editar Plano"}),e.jsx(P,{children:"Atualize os detalhes do plano de assinatura"})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"edit-name",children:"Nome do Plano *"}),e.jsx(r,{id:"edit-name",name:"name",required:!0,defaultValue:t?.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"edit-price",children:"Preço (R$) *"}),e.jsx(r,{id:"edit-price",name:"price",type:"number",step:"0.01",required:!0,defaultValue:t?t.price/100:""})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"edit-credits",children:"Número de Diárias *"}),e.jsx(r,{id:"edit-credits",name:"credits",type:"number",required:!0,defaultValue:t?.credits})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"edit-validityDays",children:"Validade (dias) *"}),e.jsx(r,{id:"edit-validityDays",name:"validityDays",type:"number",required:!0,defaultValue:t?.validityDays})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"edit-description",children:"Descrição"}),e.jsx(r,{id:"edit-description",name:"description",defaultValue:t?.description||""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"edit-benefits",children:"Benefícios"}),e.jsx(w,{id:"edit-benefits",name:"benefits",rows:4,defaultValue:t?.benefits||""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"edit-isActive",name:"isActive",defaultChecked:t?.isActive,className:"h-4 w-4"}),e.jsx(i,{htmlFor:"edit-isActive",children:"Plano ativo"})]})]}),e.jsxs(A,{children:[e.jsx(d,{type:"button",variant:"outline",onClick:()=>{o(!1),p(null)},children:"Cancelar"}),e.jsx(d,{type:"submit",disabled:x.isPending,children:x.isPending?"Salvando...":"Salvar Alterações"})]})]})})})]})})}export{ne as default};
