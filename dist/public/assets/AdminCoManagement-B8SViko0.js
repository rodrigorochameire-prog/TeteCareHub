import{m as U,r as y,t as h,j as e,C as i,f as n,b as u,d as j,B as E,n as I,S as K}from"./index-DG0yx2hi.js";import{A as _}from"./AdminLayout-CapzJ-JK.js";import{B as Q,P as W}from"./popover-Bqiz4euq.js";import{S as C,a as b,b as w,c as A,d as t}from"./select-k5kl2mY3.js";import{A as p}from"./activity-DL-_hozy.js";import{U as X}from"./users-DD1qYPM2.js";import{U as Y}from"./user-B4BzRHVK.js";import{T as G}from"./trending-up-C2VanZIM.js";import{C as Z}from"./clock-BQzFMz2h.js";import{R as T,L as q,C as z,X as J,Y as O,T as D,b as ee,a as R,c as se}from"./LineChart-CD6pLqis.js";import{P as te,a as ae}from"./PieChart-BQ4Gmhp3.js";import"./scroll-area-C0S6gB82.js";import"./index-BdQq_4o_.js";import"./layout-dashboard-CC4g-mOh.js";import"./wallet-CKmMh37E.js";import"./index-r4-iOF84.js";import"./chevron-down-CKVtRMqG.js";import"./check-DDByOptX.js";import"./findIndex-Ckvz6Jh7.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=U("Apple",[["path",{d:"M12 20.94c1.5 0 2.75 1.06 4 1.06 3 0 6-8 6-12.22A4.91 4.91 0 0 0 17 5c-2.22 0-4 1.44-5 2-1-.56-2.78-2-5-2a4.9 4.9 0 0 0-5 4.78C2 14 5 22 8 22c1.25 0 2.5-1.06 4-1.06Z",key:"3s7exb"}],["path",{d:"M10 2c1 .5 2 2 2 5",key:"fcco2y"}]]);function Ae(){const[f,B]=y.useState("7d"),[M,P]=y.useState("all"),{data:a}=h.changeHistory.getCollaborationStats.useQuery(),{data:g}=h.changeHistory.getRecentChanges.useQuery({limit:50}),S={"24h":1,"7d":7,"30d":30,all:90}[f]||7,{data:L,isLoading:V}=h.changeHistory.getActivityByDay.useQuery({days:S}),r={totalChanges:a?.totalChanges||0,adminChanges:a?.adminChanges||0,tutorChanges:a?.tutorChanges||0,todayChanges:g?.filter(s=>{const l=new Date(s.createdAt),d=new Date;return l.toDateString()===d.toDateString()}).length||0},v=L?.map(s=>({date:new Date(s.date).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"}),admin:s.adminChanges,tutor:s.tutorChanges}))||[],N=[{name:"Medicamentos",value:a?.byResourceType?.medication||0,color:"#8B5CF6"},{name:"Alimentação",value:a?.byResourceType?.food||0,color:"#10B981"},{name:"Preventivos",value:a?.byResourceType?.preventive||0,color:"#F59E0B"},{name:"Dados do Pet",value:a?.byResourceType?.pet_data||0,color:"#3B82F6"},{name:"Calendário",value:a?.byResourceType?.calendar||0,color:"#EC4899"}].filter(s=>s.value>0);function $(s){const l=new Date,d=new Date(s),c=l.getTime()-d.getTime(),o=Math.floor(c/6e4),m=Math.floor(c/36e5),x=Math.floor(c/864e5);return o<1?"Agora":o<60?`Há ${o} minuto${o>1?"s":""}`:m<24?`Há ${m} hora${m>1?"s":""}`:x<7?`Há ${x} dia${x>1?"s":""}`:d.toLocaleDateString("pt-BR")}const k=(g||[]).slice(0,20).map(s=>({id:s.id,type:s.resourceType,action:s.changeType,user:`Usuário #${s.changedBy}`,role:s.changedByRole,pet:`Pet #${s.petId}`,field:s.fieldName,oldValue:s.oldValue,newValue:s.newValue,timestamp:$(s.createdAt)})),H=s=>{switch(s){case"medication":return e.jsx(W,{className:"h-4 w-4"});case"food":return e.jsx(re,{className:"h-4 w-4"});case"preventive":return e.jsx(K,{className:"h-4 w-4"});case"pet_data":return e.jsx(p,{className:"h-4 w-4"});case"calendar":return e.jsx(I,{className:"h-4 w-4"});default:return e.jsx(p,{className:"h-4 w-4"})}},F=s=>({medication:"Medicamento",food:"Alimentação",preventive:"Preventivo",pet_data:"Dados do Pet",calendar:"Calendário"})[s]||s;return e.jsx(_,{children:e.jsxs("div",{className:"container max-w-7xl py-8 space-y-8 animate-fade-in",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold mb-2",children:"Cogestão Admin-Tutor"}),e.jsx("p",{className:"text-muted-foreground",children:"Acompanhe todas as alterações feitas por administradores e tutores em tempo real"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx(i,{children:e.jsx(n,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total de Alterações"}),e.jsx("p",{className:"text-3xl font-bold",children:r.totalChanges}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Últimos 7 dias"})]}),e.jsx(p,{className:"h-10 w-10 text-primary"})]})})}),e.jsx(i,{children:e.jsx(n,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Por Administradores"}),e.jsx("p",{className:"text-3xl font-bold text-purple-600",children:r.adminChanges}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[Math.round(r.adminChanges/r.totalChanges*100),"% do total"]})]}),e.jsx(X,{className:"h-10 w-10 text-purple-600"})]})})}),e.jsx(i,{children:e.jsx(n,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Por Tutores"}),e.jsx("p",{className:"text-3xl font-bold text-green-600",children:r.tutorChanges}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[Math.round(r.tutorChanges/r.totalChanges*100),"% do total"]})]}),e.jsx(Y,{className:"h-10 w-10 text-green-600"})]})})}),e.jsx(i,{children:e.jsx(n,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Hoje"}),e.jsx("p",{className:"text-3xl font-bold text-blue-600",children:r.todayChanges}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[e.jsx(G,{className:"inline h-3 w-3 mr-1"}),"+15% vs ontem"]})]}),e.jsx(Z,{className:"h-10 w-10 text-blue-600"})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[e.jsxs(i,{children:[e.jsx(u,{children:e.jsx(j,{children:"Atividade por Dia"})}),e.jsx(n,{children:V?e.jsx("div",{className:"flex items-center justify-center h-[300px]",children:e.jsx("p",{className:"text-muted-foreground",children:"Carregando dados..."})}):v.length===0?e.jsx("div",{className:"flex items-center justify-center h-[300px]",children:e.jsx("p",{className:"text-muted-foreground",children:"Nenhuma atividade registrada no período"})}):e.jsx(T,{width:"100%",height:300,children:e.jsxs(q,{data:v,children:[e.jsx(z,{strokeDasharray:"3 3"}),e.jsx(J,{dataKey:"date"}),e.jsx(O,{}),e.jsx(D,{}),e.jsx(ee,{}),e.jsx(R,{type:"monotone",dataKey:"admin",stroke:"#8B5CF6",name:"Admin",strokeWidth:2}),e.jsx(R,{type:"monotone",dataKey:"tutor",stroke:"#10B981",name:"Tutor",strokeWidth:2})]})})})]}),e.jsxs(i,{children:[e.jsx(u,{children:e.jsx(j,{children:"Alterações por Tipo"})}),e.jsx(n,{children:e.jsx(T,{width:"100%",height:300,children:e.jsxs(te,{children:[e.jsx(ae,{data:N,cx:"50%",cy:"50%",labelLine:!1,label:({name:s,percent:l})=>`${s} ${(l*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:N.map((s,l)=>e.jsx(se,{fill:s.color},`cell-${l}`))}),e.jsx(D,{})]})})})]})]}),e.jsx(i,{className:"mb-6",children:e.jsx(n,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Período"}),e.jsxs(C,{value:f,onValueChange:B,children:[e.jsx(b,{children:e.jsx(w,{})}),e.jsxs(A,{children:[e.jsx(t,{value:"24h",children:"Últimas 24 horas"}),e.jsx(t,{value:"7d",children:"Últimos 7 dias"}),e.jsx(t,{value:"30d",children:"Últimos 30 dias"}),e.jsx(t,{value:"all",children:"Todos"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Tipo de Recurso"}),e.jsxs(C,{value:M,onValueChange:P,children:[e.jsx(b,{children:e.jsx(w,{})}),e.jsxs(A,{children:[e.jsx(t,{value:"all",children:"Todos"}),e.jsx(t,{value:"medication",children:"Medicamentos"}),e.jsx(t,{value:"food",children:"Alimentação"}),e.jsx(t,{value:"preventive",children:"Preventivos"}),e.jsx(t,{value:"pet_data",children:"Dados do Pet"}),e.jsx(t,{value:"calendar",children:"Calendário"})]})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx(E,{variant:"outline",className:"w-full",children:"Exportar Relatório"})})]})})}),e.jsxs(i,{children:[e.jsx(u,{children:e.jsx(j,{children:"Alterações Recentes"})}),e.jsx(n,{children:e.jsx("div",{className:"space-y-4",children:k.map(s=>e.jsxs("div",{className:"flex items-start gap-4 p-4 border rounded-lg hover:bg-muted/50 transition-colors",children:[e.jsx("div",{className:"mt-1",children:H(s.type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Q,{variant:s.role==="admin"?"default":"secondary",children:s.role==="admin"?"Admin":"Tutor"}),e.jsx("span",{className:"font-medium",children:s.user}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"•"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:s.pet})]}),e.jsxs("p",{className:"text-sm mb-2",children:[e.jsxs("span",{className:"font-medium",children:[F(s.type),":"]})," ",s.field]}),s.oldValue&&e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("span",{className:"text-muted-foreground line-through",children:s.oldValue}),e.jsx("span",{children:"→"}),e.jsx("span",{className:"text-green-600 font-medium",children:s.newValue})]}),!s.oldValue&&e.jsx("div",{className:"text-xs",children:e.jsx("span",{className:"text-green-600 font-medium",children:s.newValue})})]}),e.jsx("div",{className:"text-xs text-muted-foreground whitespace-nowrap",children:s.timestamp})]},s.id))})})]})]})})}export{Ae as default};
